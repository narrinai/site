<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex">
  <title>My AI Companions | Mental Clarity Conversations Overview - Narrin AI</title>
  <meta name="description" content="View all your mental clarity conversations with AI companions. Track progress, organize thoughts, and continue transforming mental chaos into clear thinking.">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://narrin.ai/chat-overview">
  <meta property="og:title" content="My AI Companions | Mental Clarity Conversations - Narrin AI">
  <meta property="og:description" content="Track your mental clarity journey across all AI companion conversations. Organize thoughts and transform daily mental chaos into clear thinking.">
  <meta property="og:image" content="https://narrin.ai/og-image.jpg">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://narrin.ai/chat-overview">
  <meta property="twitter:title" content="My AI Companions | Mental Clarity Conversations - Narrin AI">
  <meta property="twitter:description" content="Track your mental clarity journey with AI companions. Continue conversations that help organize thoughts and transform mental chaos.">
  <meta property="twitter:image" content="https://narrin.ai/og-image.jpg">
  
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  
  <!-- Microsoft Clarity Analytics -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "svaxez2fed");
  </script>
  

  <!-- Favicon -->

  <!-- Import Modern Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    /* ===== CSS CUSTOM PROPERTIES ===== */
    :root {
      /* Primary Colors */
      --color-white: #ffffff;
      --color-off-white: #fafafa;
      --color-light-gray: #f5f5f5;
      
      /* Accent Colors */
      --color-teal: #14b8a6;
      --color-teal-light: #5eead4;
      --color-teal-dark: #0f766e;
      --color-teal-alt: #10a394;
      --color-coral: #f97316;
      --color-coral-light: #fb923c;
      --color-coral-dark: #ea580c;
      
      /* Supporting Colors */
      --color-navy: #1e293b;
      --color-navy-light: #334155;
      --color-gray: #64748b;
      --color-gray-light: #94a3b8;
      --color-gray-dark: #475569;
      
      /* Gradients */
      --gradient-primary: linear-gradient(135deg, var(--color-teal) 0%, var(--color-coral) 100%);
      --gradient-subtle: linear-gradient(135deg, var(--color-teal-light) 0%, var(--color-coral-light) 100%);
      --gradient-tags: linear-gradient(135deg, var(--color-teal-alt) 0%, var(--color-coral) 100%);
      
      /* Shadows */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-colored: 0 10px 25px -5px rgba(20, 184, 166, 0.2);
      
      /* Spacing */
      --spacing-xs: 0.5rem;
      --spacing-sm: 0.75rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;
      --spacing-2xl: 3rem;
      --spacing-3xl: 4rem;
      
      /* Typography */
      --font-primary: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-secondary: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
      
      /* Font Sizes */
      --font-size-xs: 0.75rem;
      --font-size-sm: 0.875rem;
      --font-size-base: 1rem;
      --font-size-lg: 1.125rem;
      --font-size-xl: 1.25rem;
      --font-size-2xl: 1.5rem;
      --font-size-3xl: 1.875rem;
      --font-size-4xl: 2.25rem;
      
      /* Border Radius */
      --radius-sm: 6px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      
      /* Transitions */
      --transition-fast: 150ms ease-out;
      --transition-base: 300ms ease-out;
      --transition-slow: 500ms ease-out;
      
      /* Touch Target Size */
      --touch-target: 44px;
      
      /* Z-index Scale */
      --z-dropdown: 100;
      --z-sticky: 200;
      --z-overlay: 300;
      --z-modal: 400;
      --z-menu-overlay: 500;
    }

    /* ===== RESET & BASE STYLES ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      overflow-x: hidden;
    }

    body {
      font-family: var(--font-primary);
      background: var(--color-off-white);
      color: var(--color-navy);
      line-height: 1.6;
      font-size: var(--font-size-base);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
      width: 100%;
    }

    /* ===== ACCESSIBILITY ===== */
    :focus {
      outline: 2px solid var(--color-teal);
      outline-offset: 2px;
    }

    :focus:not(:focus-visible) {
      outline: none;
    }

    /* ===== HEADER NAVIGATION ===== */
    .header {
      position: sticky;
      top: 0;
      z-index: var(--z-sticky);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      transition: all var(--transition-base);
    }

    .header-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 var(--spacing-lg);
      width: 100%;
      overflow: hidden;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-height: 72px;
      gap: var(--spacing-lg);
      width: 100%;
    }

    /* Logo */
    .logo {
      font-family: var(--font-secondary);
      font-size: var(--font-size-xl);
      font-weight: 800;
      text-decoration: none;
      letter-spacing: -0.02em;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      transition: transform var(--transition-base);
      flex-shrink: 0;
    }

    .logo:hover {
      transform: scale(1.05);
    }

    /* Desktop Navigation Center */
    .nav-center {
      display: none;
      align-items: center;
      gap: var(--spacing-lg);
      flex: 1;
      justify-content: center;
      position: relative;
    }

    /* USPs Container - Desktop */
    .nav-usps {
      display: flex;
      align-items: center;
      gap: var(--spacing-xl);
      height: auto;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    .usp-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-xs);
      color: var(--color-gray-dark);
      font-size: var(--font-size-xs);
      font-weight: 500;
      white-space: nowrap;
    }

    .usp-icon {
      font-size: var(--font-size-lg);
      color: var(--color-teal);
    }
    /* Mobile USP Carousel adjustments */
    @media (max-width: 768px) {
      .nav-usps {
        height: 32px;
      }
      .usp-item {
        font-size: var(--font-size-xs);
        gap: var(--spacing-xs);
      }
      .usp-icon {
        font-size: var(--font-size-sm);
      }
    }

    .nav-search {
      position: relative;
      width: 100%;
      max-width: 700px;
      margin-left: var(--spacing-xl);
    }

    .nav-search-input {
      width: 100%;
      padding: var(--spacing-sm) var(--spacing-lg);
      padding-right: calc(var(--spacing-lg) * 2.5);
      font-size: var(--font-size-sm);
      font-family: inherit;
      border: 2px solid var(--color-light-gray);
      border-radius: var(--radius-full);
      background: var(--color-white);
      color: var(--color-navy);
      transition: all var(--transition-base);
    }

    .nav-search-input:hover {
      border-color: var(--color-gray-light);
    }

    .nav-search-input:focus {
      border-color: var(--color-teal);
      box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }

    .nav-search-input::placeholder {
      color: var(--color-gray-light);
    }

    .search-submit {
      position: absolute;
      right: 6px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--gradient-primary);
      border: none;
      border-radius: var(--radius-full);
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .search-submit:hover {
      transform: translateY(-50%) scale(1.1);
    }

    .search-submit svg {
      width: 18px;
      height: 18px;
      color: var(--color-white);
    }

    /* Navigation Links - Desktop */
    .nav-links {
      display: none;
      align-items: center;
      gap: var(--spacing-xl);
    }

    .nav-link {
      color: var(--color-navy);
      text-decoration: none;
      font-weight: 500;
      font-size: var(--font-size-sm);
      transition: color var(--transition-base);
      position: relative;
      padding: var(--spacing-xs) 0;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--gradient-primary);
      transition: width var(--transition-base);
    }

    .nav-link:hover {
      color: var(--color-teal);
    }

    .nav-link:hover::after {
      width: 100%;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: var(--spacing-sm) var(--spacing-lg);
      font-size: var(--font-size-sm);
      font-weight: 600;
      text-decoration: none;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all var(--transition-base);
      min-height: var(--touch-target);
      white-space: nowrap;
    }

    .btn-primary {
      background: var(--gradient-primary);
      color: var(--color-white);
      box-shadow: var(--shadow-colored);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Mobile Navigation Container */
    .mobile-nav-container {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      flex-shrink: 0;
    }

    /* Mobile Chat Button */
    .mobile-chat-btn {
      display: none;
      align-items: center;
      justify-content: center;
      width: var(--touch-target);
      height: var(--touch-target);
      background: transparent;
      border: none;
      cursor: pointer;
      color: var(--color-navy);
      transition: all var(--transition-base);
      border-radius: var(--radius-md);
      flex-shrink: 0;
      text-decoration: none;
    }

    .mobile-chat-btn:hover {
      background: var(--color-light-gray);
    }

    .mobile-chat-btn svg {
      width: 24px;
      height: 24px;
    }

    /* Mobile Search Button - DISABLED */
    .mobile-search-btn {
      display: none;
      align-items: center;
      justify-content: center;
      width: var(--touch-target);
      height: var(--touch-target);
      background: transparent;
      border: none;
      cursor: pointer;
      color: var(--color-navy);
      transition: all var(--transition-base);
      border-radius: var(--radius-md);
      flex-shrink: 0;
    }

    .mobile-search-btn:hover {
      background: var(--color-light-gray);
    }

    .mobile-search-btn svg {
      width: 24px;
      height: 24px;
    }

    /* Mobile Hamburger Menu */
    .mobile-menu-btn {
      display: none;
      align-items: center;
      justify-content: center;
      width: var(--touch-target);
      height: var(--touch-target);
      background: transparent;
      border: none;
      cursor: pointer;
      color: var(--color-navy);
      transition: all var(--transition-base);
      border-radius: var(--radius-md);
      position: relative;
      flex-shrink: 0;
      z-index: var(--z-menu-overlay);
    }

    .mobile-menu-btn:hover {
      background: var(--color-light-gray);
    }

    .hamburger {
      width: 24px;
      height: 18px;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .hamburger span {
      display: block;
      height: 2px;
      width: 100%;
      background: var(--color-navy);
      border-radius: 1px;
      transition: all var(--transition-base);
    }

    .mobile-menu-btn.active .hamburger span:nth-child(1) {
      transform: rotate(45deg) translate(6px, 6px);
    }

    .mobile-menu-btn.active .hamburger span:nth-child(2) {
      opacity: 0;
    }

    .mobile-menu-btn.active .hamburger span:nth-child(3) {
      transform: rotate(-45deg) translate(6px, -6px);
    }

    /* Mobile Menu Overlay - Full Screen */
    .mobile-menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(30, 41, 59, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index: var(--z-overlay);
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-base);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .mobile-menu-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .mobile-menu-content {
      background: var(--color-white);
      border-radius: var(--radius-xl);
      padding: var(--spacing-3xl) var(--spacing-xl);
      box-shadow: var(--shadow-xl);
      max-width: 90vw;
      width: 100%;
      max-width: 400px;
      transform: scale(0.9) translateY(20px);
      transition: all var(--transition-base);
      position: relative;
    }

    .mobile-menu-overlay.active .mobile-menu-content {
      transform: scale(1) translateY(0);
    }
    .mobile-menu-close {
      position: absolute;
      top: var(--spacing-lg);
      right: var(--spacing-lg);
      width: var(--touch-target);
      height: var(--touch-target);
      background: transparent;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      color: var(--color-gray);
      transition: all var(--transition-base);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
    }
    .mobile-menu-close:hover {
      background: var(--color-light-gray);
      color: var(--color-navy);
    }
    .mobile-menu-close svg {
      width: 24px;
      height: 24px;
    }

    .mobile-menu-header {
      text-align: center;
      margin-bottom: var(--spacing-2xl);
    }

    .mobile-menu-logo {
      font-family: var(--font-secondary);
      font-size: var(--font-size-2xl);
      font-weight: 800;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: var(--spacing-sm);
    }

    .mobile-menu-subtitle {
      color: var(--color-gray);
      font-size: var(--font-size-sm);
    }

    .mobile-menu-nav {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
    }

    .mobile-menu-link {
      display: flex;
      align-items: center;
      padding: var(--spacing-md) var(--spacing-lg);
      color: var(--color-navy);
      text-decoration: none;
      font-weight: 500;
      font-size: var(--font-size-base);
      transition: all var(--transition-base);
      border-radius: var(--radius-md);
      background: var(--color-off-white);
    }

    .mobile-menu-link:hover {
      background: var(--color-light-gray);
      color: var(--color-teal);
      transform: translateX(4px);
    }

    .mobile-menu-link.btn-primary {
      background: var(--gradient-primary);
      color: var(--color-white);
      justify-content: center;
      font-weight: 700;
      margin-top: var(--spacing-lg);
    }

    .mobile-menu-link.btn-primary:hover {
      background: var(--gradient-primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .mobile-menu-link-icon {
      margin-right: var(--spacing-sm);
      font-size: var(--font-size-lg);
    }

    /* Mobile Search Overlay */
    .mobile-search-overlay {
      position: fixed;
      top: 72px;
      left: 0;
      right: 0;
      background: var(--color-white);
      padding: var(--spacing-lg);
      box-shadow: var(--shadow-lg);
      transform: translateY(-100%);
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-base);
      z-index: var(--z-dropdown);
    }

    .mobile-search-overlay.active {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .mobile-search-form {
      display: flex;
      gap: var(--spacing-sm);
    }

    .mobile-search-input {
      flex: 1;
      padding: var(--spacing-md);
      font-size: var(--font-size-base);
      font-family: inherit;
      border: 2px solid var(--color-light-gray);
      border-radius: var(--radius-md);
      background: var(--color-white);
      color: var(--color-navy);
      transition: all var(--transition-base);
    }

    .mobile-search-input:focus {
      border-color: var(--color-teal);
      box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }

    /* Desktop Styles */
    @media (min-width: 769px) {
      .nav-center {
        display: flex;
      }

      .nav-links {
        display: flex;
      }

      .mobile-nav-container {
        display: none;
      }

      .mobile-chat-btn {
        display: none !important;
      }

      .mobile-search-btn {
        display: none !important;
      }

      .mobile-menu-btn {
        display: none;
      }

      .mobile-menu-overlay {
        display: none !important;
      }
    }

    /* Mobile Styles */
    @media (max-width: 768px) {
      .header-container {
        padding: 0 var(--spacing-md);
      }

      .header-content {
        min-height: 60px;
        gap: var(--spacing-sm);
        padding: 0;
        display: grid;
        grid-template-columns: auto 1fr auto auto auto;
        align-items: center;
      }

      .logo {
        font-size: var(--font-size-lg);
        flex-shrink: 0;
        min-width: fit-content;
        grid-column: 1;
      }

      .mobile-nav-container {
        flex-shrink: 0;
        min-width: fit-content;
        display: flex !important;
        gap: var(--spacing-xs);
        grid-column: 3 / 6;
        justify-self: end;
      }

      .mobile-chat-btn {
        display: flex;
        flex-shrink: 0;
      }

      .nav-center {
        display: none !important;
      }

      .nav-links {
        display: none !important;
      }

      .mobile-search-btn {
        display: flex;
        flex-shrink: 0;
      }

      .mobile-menu-btn {
        display: flex;
        flex-shrink: 0;
      }

      .mobile-search-overlay {
        top: 60px;
      }
    }

    /* Extra small mobile devices */
    @media (max-width: 480px) {
      .header-content {
        gap: var(--spacing-xs);
        grid-template-columns: auto 1fr auto auto auto;
      }
      
      .logo {
        font-size: var(--font-size-base);
      }
    }

    /* Netlify Identity Modal Positioning - EXTREME Z-INDEX FIX */
    .netlify-identity-widget,
    .netlify-identity-widget *,
    .netlify-identity-widget iframe,
    [data-netlify-identity-widget],
    [data-netlify-identity-modal],
    div[data-netlify-identity-widget],
    iframe[src*="netlify"] {
      z-index: 2147483647 !important;
      position: relative !important;
    }
    
    /* Force modal above everything */
    .netlify-identity-widget > div[style*="position: fixed"],
    .netlify-identity-widget > div[data-netlify-identity-modal] {
      z-index: 2147483647 !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
    }
    
    /* Lower header z-index when modal is open */
    body:has(.netlify-identity-widget) .header,
    body:has(.netlify-identity-widget) .mobile-menu-overlay,
    body:has(.netlify-identity-widget) nav,
    body:has(.netlify-identity-widget) header {
      z-index: 1 !important;
      position: relative !important;
    }
    
    /* Add "by signing up" disclaimer to signup form */
    .netlify-identity-widget .form[data-goatcounter-click="signup"]::after,
    .netlify-identity-widget .form.signup::after,
    .netlify-identity-widget .signUp::after {
      content: "By signing up, you agree to our Terms and Conditions and Privacy Policy.";
      display: block;
      font-size: 12px;
      color: #666;
      margin-top: 12px;
      text-align: center;
      line-height: 1.4;
    }

    /* Force modal to appear ABOVE header on mobile */
    @media (max-width: 768px) {
      .netlify-identity-widget {
        position: fixed !important;
        top: 0 !important; /* Above header */
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        z-index: 2147483647 !important;
      }
      
      .netlify-identity-widget > div {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        z-index: 2147483647 !important;
        margin: 0 !important;
        padding: 20px !important;
        box-sizing: border-box !important;
      }

      .netlify-identity-widget .netlify-identity-modal {
        position: relative !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        border-radius: 12px !important;
        z-index: 2147483647 !important;
      }
    }

    /* Desktop modal positioning */
    @media (min-width: 769px) {
      .netlify-identity-widget .netlify-identity-modal {
        margin-top: 100px !important; /* Space for header */
      }
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: var(--spacing-xl);
      position: relative;
    }

    /* Modern Background with Subtle Pattern */
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 300px;
      background: var(--color-off-white);
      border-radius: var(--radius-xl);
      z-index: -1;
      opacity: 0.8;
    }

    .page-header {
      text-align: center;
      margin-bottom: var(--spacing-2xl);
    }

    .page-header h1 {
      font-family: var(--font-secondary);
      font-size: clamp(var(--font-size-2xl), 5vw, var(--font-size-4xl));
      margin: 0 0 var(--spacing-lg) 0;
      color: var(--color-navy);
      font-weight: 800;
      letter-spacing: -0.02em;
      line-height: 1.2;
    }

    .page-header p {
      color: var(--color-gray);
      font-size: var(--font-size-lg);
      margin: 0;
      font-weight: 400;
    }

    .loading-state {
      text-align: center;
      padding: var(--spacing-3xl) var(--spacing-xl);
      color: var(--color-gray);
    }

    .loading-state h3 {
      font-family: var(--font-secondary);
      font-size: var(--font-size-xl);
      margin: 0 0 var(--spacing-md) 0;
      color: var(--color-navy);
      font-weight: 700;
    }

    .error-state {
      text-align: center;
      padding: var(--spacing-2xl) var(--spacing-xl);
      color: #c53030;
      background: #fed7d7;
      border-radius: var(--radius-lg);
      margin-bottom: var(--spacing-xl);
      border-left: 4px solid #c53030;
      box-shadow: var(--shadow-sm);
    }

    .error-state h3 {
      margin: 0 0 var(--spacing-xs) 0;
      color: #c53030;
      font-family: var(--font-secondary);
      font-size: var(--font-size-xl);
      font-weight: 700;
    }

    .not-logged-in {
      text-align: center;
      padding: var(--spacing-3xl) var(--spacing-xl);
      background: var(--color-white);
      border-radius: var(--radius-lg);
      margin: var(--spacing-xl) 0;
      border: 2px solid var(--color-light-gray);
      box-shadow: var(--shadow-md);
    }

    .not-logged-in h3 {
      font-family: var(--font-secondary);
      font-size: var(--font-size-2xl);
      margin: 0 0 var(--spacing-md) 0;
      color: var(--color-navy);
      font-weight: 700;
    }

    .not-logged-in p {
      color: var(--color-gray);
      margin: 0 0 var(--spacing-2xl) 0;
      font-size: var(--font-size-base);
    }

    /* Chats Section */
    .chats-section {
      margin-bottom: var(--spacing-3xl);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-xl);
    }

    .section-title {
      font-family: var(--font-secondary);
      font-size: var(--font-size-2xl);
      margin: 0;
      color: var(--color-navy);
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .chats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
      gap: var(--spacing-2xl);
      padding: var(--spacing-lg) 0;
    }

    /* Center companions when there are only 1 or 2 */
    .chats-grid.center-few {
      justify-content: center;
      grid-template-columns: repeat(auto-fit, minmax(380px, 400px));
      max-width: 860px; /* Space for 2 cards plus gap */
      margin: 0 auto;
    }

    /* ===== GEAVANCEERDE CHAT CARD STYLING ZOALS INDEX.HTML ===== */
    .chat-card {
      background: var(--color-white);
      border: 2px solid var(--color-light-gray);
      border-radius: var(--radius-lg);
      padding: var(--spacing-xl);
      text-decoration: none;
      color: inherit;
      transition: all var(--transition-base);
      cursor: pointer;
      box-shadow: var(--shadow-sm);
      position: relative;
      display: block;
    }

    /* Verwijder complexe animaties en effecten voor subtielere hover */
    .chat-card::before,
    .chat-card::after,
    .chat-avatar::before,
    .chat-avatar::after {
      display: none !important;
    }

    /* Verwijder floating animatie */
    .chat-card {
      animation: none;
    }

    /* Verwijder shimmer animaties */
    .chat-name {
      background: var(--color-navy);
      background-clip: initial;
      -webkit-background-clip: initial;
      -webkit-text-fill-color: initial;
      animation: none;
    }

    .chat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
      border-color: var(--color-teal);
    }
    
    
    .chat-card.paused {
      opacity: 0.7;
      filter: grayscale(30%);
    }
    
    .chat-card.paused::after {
      content: 'PAUSED';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(239, 68, 68, 0.9);
      color: white;
      padding: 4px 12px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 1px;
      pointer-events: none;
      z-index: 5;
    }

    /* Floating animation for cards */
    .chat-card:nth-child(2n),
    .chat-card:nth-child(3n) {
      animation: none;
    }

    @keyframes float {
      /* Deactiveer floating animatie */
    }

    .chat-header {
      display: flex;
      align-items: center;
      gap: var(--spacing-xl);
      margin-bottom: var(--spacing-xl);
      position: relative;
      z-index: 2;
    }

    .chat-avatar {
      width: 80px;
      height: 80px;
      border-radius: var(--radius-full);
      background: linear-gradient(145deg,
        rgba(255, 255, 255, 0.9) 0%,
        rgba(240, 253, 250, 0.8) 50%,
        rgba(204, 251, 241, 0.6) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--font-size-2xl);
      border: 2px solid var(--color-light-gray);
      overflow: hidden;
      flex-shrink: 0;
      transition: all 0.3s ease;
      position: relative;
      box-shadow:
        0 4px 12px rgba(20, 184, 166, 0.1),
        0 2px 6px rgba(0, 0, 0, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
      z-index: 3;
    }

    /* Rotating gradient ring */
    .chat-avatar::before {
      content: '';
      position: absolute;
      top: -4px;
      left: -4px;
      right: -4px;
      bottom: -4px;
      background: conic-gradient(from 0deg,
        var(--color-teal),
        var(--color-coral),
        var(--color-teal-light),
        var(--color-coral-light),
        var(--color-teal));
      border-radius: var(--radius-full);
      z-index: -1;
      opacity: 0;
      animation: avatarRotate 4s linear infinite;
      transition: opacity 0.5s ease;
    }

    /* Inner glow effect */
    .chat-avatar::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 60%;
      height: 60%;
      background: radial-gradient(circle,
        rgba(20, 184, 166, 0.2) 0%,
        transparent 70%);
      border-radius: var(--radius-full);
      z-index: 1;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .chat-card:hover .chat-avatar::before {
      opacity: 1;
    }

    .chat-card:hover .chat-avatar::after {
      opacity: 1;
    }

    .chat-card:hover .chat-avatar {
      transform: scale(1.05);
      box-shadow:
        0 8px 20px rgba(20, 184, 166, 0.25),
        0 4px 10px rgba(0, 0, 0, 0.15),
        0 2px 4px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
      background: linear-gradient(145deg,
        rgba(255, 255, 255, 0.95) 0%,
        rgba(204, 251, 241, 0.9) 100%);
      border-color: var(--color-teal);
    }

    @keyframes avatarRotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .chat-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: var(--radius-full);
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 2;
      position: relative;
      filter: brightness(1.05) contrast(1.1);
    }

    .chat-card:hover .chat-avatar img {
      transform: scale(1.05);
      filter: brightness(1.05) contrast(1.1) saturate(1.1);
    }

    .chat-info {
      flex: 1;
      min-width: 0;
      position: relative;
      z-index: 2;
    }

    .chat-name {
      font-weight: 800;
      margin: 0 0 var(--spacing-sm) 0;
      font-size: var(--font-size-xl);
      letter-spacing: -0.02em;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background: linear-gradient(135deg,
        var(--color-navy) 0%,
        var(--color-teal-dark) 50%,
        var(--color-navy) 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: textShimmer 3s ease-in-out infinite;
      position: relative;
    }

    @keyframes textShimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .chat-card:hover .chat-name {
      background: linear-gradient(135deg,
        var(--color-teal) 0%,
        var(--color-coral) 50%,
        var(--color-teal-light) 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      transform: translateY(-2px);
      animation: none;
    }

    @keyframes textShimmerHover {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .chat-title {
      font-size: var(--font-size-base);
      color: var(--color-gray);
      margin: 0 0 var(--spacing-md) 0;
      line-height: 1.5;
      font-weight: 600;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0.8;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: var(--font-size-xs);
    }

    .chat-card:hover .chat-title {
      color: var(--color-teal);
      transform: translateY(-2px);
      opacity: 1;
    }

    .chat-preview {
      color: var(--color-gray-dark);
      font-size: var(--font-size-base);
      line-height: 1.7;
      margin: 0 0 var(--spacing-xl) 0;
      display: -webkit-box;
      -webkit-line-clamp: 3;
line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      min-height: 4.8em;
      font-weight: 400;
      position: relative;
    }

    .chat-preview::after {
      content: '';
      position: absolute;
      bottom: 0;
      right: 0;
      width: 30px;
      height: 1.2em;
      background: linear-gradient(to right, transparent, var(--color-white));
      transition: background 0.4s ease;
    }

    .chat-card:hover .chat-preview {
      color: var(--color-navy);
      transform: translateY(-1px);
    }

    .chat-card:hover .chat-preview::after {
      background: linear-gradient(to right, transparent, rgba(240, 253, 250, 0.95));
    }

    .chat-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: var(--font-size-sm);
      color: var(--color-gray-light);
      padding-top: var(--spacing-lg);
      border-top: 1px solid rgba(229, 231, 235, 0.4);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      z-index: 2;
    }

    .chat-meta::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg,
        transparent 0%,
        var(--color-teal) 50%,
        transparent 100%);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .chat-card:hover .chat-meta {
      color: var(--color-teal);
      transform: translateY(-1px);
      border-top-color: transparent;
    }

    .chat-card:hover .chat-meta::before {
      opacity: 1;
    }

    .chat-date {
      font-size: var(--font-size-sm);
      color: var(--color-gray-light);
      font-weight: 600;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      padding-left: var(--spacing-lg);
    }

    .chat-date::before {
      content: '🕒';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      font-size: var(--font-size-xs);
      opacity: 0.7;
      transition: all 0.4s ease;
    }

    .chat-card:hover .chat-date {
      color: var(--color-teal);
      transform: translateX(-1px);
    }

    .chat-card:hover .chat-date::before {
      opacity: 1;
      transform: translateY(-50%) scale(1.2);
    }

    .message-count {
      background: var(--color-light-gray);
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--radius-sm);
      font-size: var(--font-size-xs);
      color: var(--color-gray-dark);
      font-weight: 600;
      transition: all var(--transition-base);
    }

    .chat-card:hover .message-count {
      background: var(--color-teal);
      color: var(--color-white);
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: var(--spacing-3xl) var(--spacing-xl);
      color: var(--color-gray);
      background: var(--color-white);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-sm);
      border: 2px solid var(--color-light-gray);
    }

    .empty-state h3 {
      font-family: var(--font-secondary);
      font-size: var(--font-size-2xl);
      margin: 0 0 var(--spacing-md) 0;
      color: var(--color-navy);
      font-weight: 700;
    }

    .empty-state p {
      margin: 0 0 var(--spacing-2xl) 0;
      font-size: var(--font-size-lg);
    }

    /* Create Character CTA */
    .create-character-cta {
      background: var(--gradient-primary);
      padding: var(--spacing-3xl);
      border-radius: var(--radius-xl);
      text-align: center;
      color: white;
      margin-top: var(--spacing-3xl);
    }

    .cta-content {
      max-width: 600px;
      margin: 0 auto;
    }

    .cta-icon {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--font-size-3xl);
      margin: 0 auto var(--spacing-xl);
      backdrop-filter: blur(10px);
    }

    .cta-content h2 {
      font-family: var(--font-secondary);
      font-size: var(--font-size-3xl);
      font-weight: 800;
      margin-bottom: var(--spacing-lg);
    }

    .cta-content p {
      font-size: var(--font-size-lg);
      margin-bottom: var(--spacing-2xl);
      opacity: 0.9;
    }

    .btn-cta {
      background: rgba(255, 255, 255, 0.9);
      color: var(--color-teal);
      font-weight: 700;
      padding: var(--spacing-md) var(--spacing-2xl);
      font-size: var(--font-size-base);
    }

    .btn-cta:hover {
      background: white;
      transform: translateY(-2px);
    }

    @media (max-width: 768px) {
      .container {
        padding: var(--spacing-md);
      }

      .container::before {
        height: 200px;
        opacity: 0.6;
      }


      .chats-grid {
        grid-template-columns: 1fr;
        gap: var(--spacing-xl);
        padding: var(--spacing-md) 0;
      }

      .chat-card {
        padding: var(--spacing-xl);
        border-radius: var(--radius-lg);
        margin: 0 var(--spacing-xs);
      }

      .chat-card:hover {
        transform: translateY(-6px) scale(1.02);
      }

      .chat-header {
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
      }

      .chat-avatar {
        width: 70px;
        height: 70px;
        font-size: var(--font-size-xl);
      }

      .chat-card:hover .chat-avatar {
        transform: scale(1.15) rotateY(10deg) rotateX(3deg);
      }

      .chat-name {
        font-size: var(--font-size-lg);
        margin-bottom: var(--spacing-xs);
      }

      .chat-title {
        font-size: var(--font-size-xs);
        margin-bottom: var(--spacing-sm);
      }

      .chat-preview {
        font-size: var(--font-size-sm);
        line-height: 1.6;
        margin-bottom: var(--spacing-lg);
        min-height: 3.6em;
        -webkit-line-clamp: 2;
        line-clamp: 2;
      }

      .chat-meta {
        padding-top: var(--spacing-md);
        flex-direction: column;
        gap: var(--spacing-sm);
        align-items: flex-start;
      }

      .chat-date {
        padding-left: var(--spacing-md);
        font-size: var(--font-size-xs);
      }

      .message-count {
        padding: var(--spacing-xs) var(--spacing-md);
        font-size: var(--font-size-xs);
        align-self: flex-end;
      }

      .create-character-cta {
        padding: var(--spacing-2xl) var(--spacing-lg);
        margin: var(--spacing-2xl) var(--spacing-xs) 0;
        border-radius: var(--radius-lg);
      }

      /* Disable complex animations on mobile for performance */
      .chat-card {
        animation: none;
      }

      .chat-card:hover {
        animation: none;
      }

      /* Clean mobile chat cards */
      .chat-card {
        background: var(--color-white);
        box-shadow: var(--shadow-sm);
      }

      .create-character-cta {
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
      }
    }

    /* Extra small mobile devices */
    @media (max-width: 480px) {
      .container {
        padding: var(--spacing-sm);
      }


      .chats-grid {
        gap: var(--spacing-lg);
      }

      .chat-card {
        padding: var(--spacing-lg);
        margin: 0;
      }

      .chat-header {
        gap: var(--spacing-md);
      }

      .chat-avatar {
        width: 60px;
        height: 60px;
        font-size: var(--font-size-lg);
      }

      .chat-name {
        font-size: var(--font-size-base);
      }

      .chat-preview {
        font-size: var(--font-size-sm);
        min-height: 3.2em;
      }

      .create-character-cta {
        padding: var(--spacing-xl) var(--spacing-md);
      }

      .create-character-cta h2 {
        font-size: clamp(var(--font-size-lg), 5vw, var(--font-size-xl));
      }

      .create-character-cta .btn {
        padding: var(--spacing-md) var(--spacing-xl);
        font-size: var(--font-size-sm);
      }
    }

    /* Accessibility improvements */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus styles for keyboard navigation */
    .btn:focus,
    .chat-card:focus,
    .nav-search-input:focus {
      outline: 2px solid var(--color-teal);
      outline-offset: 2px;
    }

    /* ===== FOOTER STYLES ===== */
    .footer {
      background: var(--color-white);
      border-top: 1px solid var(--color-light-gray);
      padding: var(--spacing-xl) 0;
      margin-top: var(--spacing-3xl);
    }

    .footer-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 var(--spacing-lg);
      text-align: center;
    }

    .footer-links {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-lg);
      margin-bottom: var(--spacing-md);
      flex-wrap: wrap;
    }

    .footer-link {
      color: var(--color-gray);
      text-decoration: none;
      font-size: var(--font-size-sm);
      font-weight: 500;
      transition: color var(--transition-base);
    }

    .footer-link:hover {
      color: var(--color-teal);
    }

    .footer-separator {
      color: var(--color-gray-light);
      font-size: var(--font-size-sm);
    }

    .footer-copyright {
      color: var(--color-gray-light);
      font-size: var(--font-size-xs);
      margin: 0;
    }

    /* Mobile footer adjustments */
    @media (max-width: 768px) {
      .footer {
        padding: var(--spacing-lg) 0;
        margin-top: var(--spacing-2xl);
      }

      .footer-container {
        padding: 0 var(--spacing-md);
      }

      .footer-links {
        gap: var(--spacing-md);
      }
    }

    /* ===== CUSTOM NOTIFICATION SYSTEM ===== */
    .notification-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(30, 41, 59, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: var(--z-modal);
      display: none !important;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: all var(--transition-base);
    }

    .notification-overlay.active {
      display: flex;
      opacity: 1;
    }

    .notification-modal {
      background: var(--color-white);
      border-radius: var(--radius-xl);
      padding: var(--spacing-2xl);
      box-shadow: var(--shadow-xl);
      max-width: 90vw;
      width: 100%;
      max-width: 400px;
      transform: scale(0.9) translateY(20px);
      transition: all var(--transition-base);
      text-align: center;
    }

    .notification-overlay.active .notification-modal {
      transform: scale(1) translateY(0);
    }

    .notification-icon {
      font-size: var(--font-size-4xl);
      margin-bottom: var(--spacing-lg);
      display: block;
    }

    .notification-icon.error {
      color: var(--color-coral);
    }

    .notification-title {
      font-family: var(--font-secondary);
      font-size: var(--font-size-xl);
      font-weight: 700;
      color: var(--color-navy);
      margin-bottom: var(--spacing-md);
    }

    .notification-message {
      color: var(--color-gray-dark);
      font-size: var(--font-size-base);
      line-height: 1.6;
      margin-bottom: var(--spacing-xl);
    }

    .notification-buttons {
      display: flex;
      gap: var(--spacing-md);
      justify-content: center;
    }

    .notification-btn {
      padding: var(--spacing-sm) var(--spacing-lg);
      border: none;
      border-radius: var(--radius-md);
      font-size: var(--font-size-sm);
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-base);
      min-width: 100px;
      font-family: var(--font-primary);
    }

    .notification-btn.primary {
      background: var(--gradient-primary);
      color: var(--color-white);
      box-shadow: var(--shadow-colored);
    }

    .notification-btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Hide the name field in Netlify Identity widget */
    .netlify-identity-widget input[name="name"],
    .netlify-identity-widget input[placeholder="Optional"],
    .netlify-identity-widget .formGroup:first-child {
      display: none !important;
    }
  </style>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D6T01M6XTJ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D6T01M6XTJ');
  </script>
  <!-- Global Upgrade Popups -->
  <!-- DISABLED: <script src="js/upgrade-popups.js"></script> -->
  

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
</head>

<body>
  <!-- Custom Notification System -->
  <div class="notification-overlay" id="notificationOverlay">
    <div class="notification-modal">
      <span class="notification-icon" id="notificationIcon">✓</span>
      <h3 class="notification-title" id="notificationTitle">Success</h3>
      <p class="notification-message" id="notificationMessage">Operation completed successfully!</p>
      <div class="notification-buttons" id="notificationButtons">
        <button class="notification-btn primary" id="notificationOkBtn">OK</button>
      </div>
    </div>
  </div>

  <!-- Header -->
  <header class="header" role="banner">
    <div class="header-container">
      <div class="header-content">
        <!-- Logo -->
        <a href="/" class="logo" aria-label="Narrin AI Home">Narrin AI</a>

        <!-- REMOVED: Desktop navigation center with USPs -->

        <!-- Desktop Navigation Links -->
        <nav class="nav-links" role="navigation" aria-label="Secondary navigation">
          <a href="/pricing" class="nav-link">Plans</a>
          <a href="/chat-overview" class="nav-link">My Companions</a>
          <a href="/memory-import" class="nav-link">Import Memory</a>
          <a href="/news" class="nav-link">News & Insights</a>
          <a href="#" class="nav-link" id="loginBtn">Login/Register</a>
          <a href="/create-character" class="btn btn-primary">✨ Create Companion</a>
        </nav>

        <!-- Mobile Navigation Container -->
        <div class="mobile-nav-container">
          <!-- Mobile Chat Button -->
          <a
            href="/chat-overview"
            class="mobile-chat-btn"
            aria-label="Go to chats"
          >
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
          </a>

          <!-- Mobile Hamburger Menu -->
          <button
            class="mobile-menu-btn"
            id="mobileMenuBtn"
            aria-label="Open navigation menu"
            aria-expanded="false"
          >
            <div class="hamburger">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </button>
        </div>
      </div>
    </div>

  </header>

  <!-- Mobile Menu Overlay -->
  <div class="mobile-menu-overlay" id="mobileMenuOverlay">
    <div class="mobile-menu-content">
      <button class="mobile-menu-close" id="mobileMenuClose" aria-label="Sluit menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <div class="mobile-menu-header">
        <div class="mobile-menu-logo">Narrin AI</div>
        <div class="mobile-menu-subtitle">AI Companion Platform</div>
      </div>
      <nav class="mobile-menu-nav" role="navigation" aria-label="Mobile navigation">
        <a href="/chat-overview" class="mobile-menu-link">
          <span class="mobile-menu-link-icon">💬</span>
          My Companions
        </a>
        <a href="/pricing" class="mobile-menu-link">
          <span class="mobile-menu-link-icon">💎</span>
          Plans
        </a>
        <a href="/memory-import" class="mobile-menu-link">
          <span class="mobile-menu-link-icon">🧠</span>
          Import Memory
        </a>
        <a href="/news" class="mobile-menu-link">
          <span class="mobile-menu-link-icon">📰</span>
          News & Insights
        </a>
        <a href="#" class="mobile-menu-link" id="mobileLoginBtn">
          <span class="mobile-menu-link-icon">👤</span>
          Login/Register
        </a>
        <a href="/create-character" class="mobile-menu-link btn-primary">
          <span class="mobile-menu-link-icon">✨</span>
          Create Companion
        </a>
      </nav>
    </div>
  </div>

  <div class="container">
    <div class="page-header">
      <h1>My Companions</h1>
      <p>Continue your conversations with AI companions</p>
    </div>

    <!-- Free Plan Status -->
    <div class="free-plan-status" id="freePlanStatus" style="
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    ">
      <a href="profile.html#plans" id="planLimitInfo" style="
        padding: 8px 16px;
        background: linear-gradient(135deg, rgba(20, 184, 166, 0.1) 0%, rgba(249, 115, 22, 0.1) 100%);
        border-radius: 8px;
        font-size: 14px;
        color: #0f172a;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.3s;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        background: white;
      " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(20, 184, 166, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0, 0, 0, 0.08)'"></a>
    </div>

    <!-- Loading State -->
    <div id="loadingState" class="loading-state">
      <h3>Loading your chats...</h3>
      <p>Please wait while we fetch your conversation history.</p>
    </div>

    <!-- Error State -->
    <div id="errorState" class="error-state" style="display: none;">
      <h3>Unable to load chats</h3>
      <p>There was an error loading your chat history. Please try again later.</p>
    </div>

    <!-- Not Logged In State -->
    <div id="notLoggedIn" class="not-logged-in" style="display: none;">
      <h3>Ready to Be Truly Understood?</h3>
      <p>Join thousands turning daily mental chaos into clear thinking with AI&nbsp;companions.</p>
      <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 1.5rem;">
        <a href="/create-character" class="btn btn-primary" style="text-decoration: none;">✨ Create Your Companion</a>
      </div>
      <div style="margin-top: 1.5rem;">
        <a href="#" id="notLoggedInBtn" style="color: var(--color-gray); text-decoration: underline; font-size: var(--font-size-sm);">Already have an account? Login/Register</a>
      </div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" style="display: none;">
      <!-- Chats Section -->
      <div class="chats-section">
        <div id="chatsContainer">
          <div class="chats-grid" id="chatsGrid">
            <!-- Chat cards will be populated here -->
          </div>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
          <h3>No conversations yet</h3>
          <p>Create your own AI companion to start meaningful conversations</p>
          <a href="/create-character" class="btn btn-primary">✨ Create Companion</a>
        </div>
      </div>

      <!-- Create Character CTA -->
      <section class="create-character-cta">
        <div class="cta-content">
          <div class="cta-icon">✨</div>
          <h2>Create Your Own Character</h2>
          <p>Bring your imagination to life. Design unique AI personalities with custom traits, backgrounds, and conversation styles.</p>
          <a href="/create-character" class="btn btn-cta">Start Creating</a>
        </div>
      </section>
    </div>
  </div>

  <script>
    // ===== CUSTOM NOTIFICATION SYSTEM =====
    function showNotification(type, title, message, buttons = null) {
      const overlay = document.getElementById('notificationOverlay');
      const icon = document.getElementById('notificationIcon');
      const titleEl = document.getElementById('notificationTitle');
      const messageEl = document.getElementById('notificationMessage');
      const buttonsEl = document.getElementById('notificationButtons');
      
      // Set icon based on type
      const icons = {
        success: '✅',
        error: '❌',
        warning: '⚠️',
        info: 'ℹ️',
        question: '❓'
      };
      
      icon.textContent = icons[type] || icons.info;
      icon.className = `notification-icon ${type}`;
      titleEl.textContent = title;
      messageEl.textContent = message;
      
      // Set up buttons
      if (buttons) {
        buttonsEl.innerHTML = '';
        buttons.forEach(button => {
          const btn = document.createElement('button');
          btn.className = `notification-btn ${button.type || 'secondary'}`;
          btn.textContent = button.text;
          btn.onclick = () => {
            hideNotification();
            if (button.callback) button.callback();
          };
          buttonsEl.appendChild(btn);
        });
      } else {
        // Default OK button
        buttonsEl.innerHTML = '<button class="notification-btn primary" onclick="hideNotification()">OK</button>';
      }
      
      // Show notification
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function hideNotification() {
      const overlay = document.getElementById('notificationOverlay');
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    }
    
    // Error notification
    function showError(message, title = 'Error') {
      showNotification('error', title, message);
    }

    // Global variables
    let userChats = [];

    // ===== NAVIGATION FUNCTIONALITY =====
    
    // Mobile search removed
    
    // Mobile Menu Elements
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
    
    // USP Carousel Elements
    const uspTrack = document.getElementById('uspTrack');
    let currentUspIndex = 0;
    let uspInterval;

    // Mobile search functionality removed

    // ===== MOBILE MENU FUNCTIONALITY =====
    function toggleMobileMenu() {
      if (!mobileMenuOverlay) return;
      
      const isActive = mobileMenuOverlay.classList.contains('active');
      
      if (isActive) {
        closeMobileMenu();
      } else {
        openMobileMenu();
      }
    }

    function openMobileMenu() {
      if (mobileMenuOverlay) {
        mobileMenuOverlay.classList.add('active');
      }
      if (mobileMenuBtn) {
        mobileMenuBtn.classList.add('active');
        mobileMenuBtn.setAttribute('aria-expanded', 'true');
      }
      document.body.style.overflow = 'hidden';
    }

    function closeMobileMenu() {
      if (mobileMenuOverlay) {
        mobileMenuOverlay.classList.remove('active');
      }
      if (mobileMenuBtn) {
        mobileMenuBtn.classList.remove('active');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
      }
      document.body.style.overflow = '';
    }

    mobileMenuBtn?.addEventListener('click', toggleMobileMenu);
    const mobileMenuClose = document.getElementById('mobileMenuClose');
    mobileMenuClose?.addEventListener('click', closeMobileMenu);

    // Close menu when clicking on overlay background
    mobileMenuOverlay?.addEventListener('click', (e) => {
      if (e.target === mobileMenuOverlay) {
        closeMobileMenu();
      }
    });

    // Close menu when clicking on a menu item
    document.querySelectorAll('.mobile-menu-link').forEach(link => {
      link.addEventListener('click', closeMobileMenu);
    });

    // Mobile search removed - no outside click handling needed

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (mobileMenuOverlay.classList.contains('active')) {
          closeMobileMenu();
        }
      }
    });

    // ===== USP CAROUSEL FUNCTIONALITY =====
    function startUspCarousel() {
      if (window.innerWidth <= 768 && uspTrack) {
        uspInterval = setInterval(() => {
          currentUspIndex = (currentUspIndex + 1) % 3;
          uspTrack.style.transform = `translateY(-${currentUspIndex * 33.333}%)`;
        }, 3000);
      }
    }

    function stopUspCarousel() {
      if (uspInterval) {
        clearInterval(uspInterval);
        uspInterval = null;
      }
    }

    // Handle responsive behavior
    function handleResize() {
      if (window.innerWidth > 768) {
        stopUspCarousel();
        if (uspTrack) {
          uspTrack.style.transform = '';
        }
        if (mobileMenuOverlay?.classList.contains('active')) {
          closeMobileMenu();
        }
      } else {
        startUspCarousel();
      }
    }

    // Initialize on load
    window.addEventListener('load', () => {
      handleResize();
    });

    // Handle window resize
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(handleResize, 250);
    });

    // ===== SEARCH FUNCTIONALITY =====
    function handleSearch(searchTerm) {
      if (!searchTerm || !searchTerm.trim()) {
        console.log('Empty search term, ignoring');
        return;
      }
      
      const trimmedTerm = searchTerm.trim();
      console.log('Redirecting to search results for:', trimmedTerm);
      window.location.href = `search-results.html?q=${encodeURIComponent(trimmedTerm)}`;
    }

    // Desktop search
    document.querySelector('.nav-search')?.addEventListener('submit', (e) => {
      e.preventDefault();
      const searchInput = e.target.querySelector('.nav-search-input');
      handleSearch(searchInput.value);
    });

    // Mobile search
    document.querySelector('.mobile-search-form')?.addEventListener('submit', (e) => {
      e.preventDefault();
      const searchInput = e.target.querySelector('.mobile-search-input');
      handleSearch(searchInput.value);
      toggleMobileSearch();
    });

   // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      // Check voor referral parameter
      const urlParams = new URLSearchParams(window.location.search);
      const referralCode = urlParams.get('ref');
      if (referralCode) {
        localStorage.setItem('referralCode', referralCode);
        console.log('📌 Referral code opgeslagen:', referralCode);
        // Clean URL
        const cleanUrl = window.location.pathname;
        window.history.replaceState({}, document.title, cleanUrl);
      }
      
      // Initialize authentication check
  initializeAuthenticationCheck();
  
  // Run Safari compatibility checks first
  checkLocalStorageSupport();
      console.log('🚀 Chat overview page loaded');
      
      // MOBILE DEBUG: Show auth status on iPhone screen
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        setTimeout(() => {
          alert('MOBILE: Page loaded. Email=' + (localStorage.getItem('user_email') || 'none'));
        }, 1000);
      }
      
      // Run Safari compatibility checks first
      checkLocalStorageSupport();
      setupSafariFixes();
      
      // Show random USP
      const uspItems = document.querySelectorAll('.usp-item');
      if (uspItems.length > 0) {
        // Hide all USPs first
        uspItems.forEach(item => item.style.display = 'none');
        
        // Show a random one
        const randomIndex = Math.floor(Math.random() * uspItems.length);
        uspItems[randomIndex].style.display = 'flex';
      }
      runSafariCompatibilityTest();
      
      if (window.netlifyIdentity) {
        window.netlifyIdentity.init({
          namePlaceholder: 'Optional'
        });
        setupEventListeners();
        checkAuthAndLoadChats();
      } else {
        console.error('❌ Netlify Identity not loaded');
        showError('Authentication system not available');
      }
    });

    function setupEventListeners() {
      window.netlifyIdentity.on('init', user => {
        updateLoginButton();
        if (user) {
          checkAuthAndLoadChats();
        }
      });

      window.netlifyIdentity.on('login', user => {
        updateLoginButton();
        window.netlifyIdentity.close();
        checkAuthAndLoadChats();
      });

      window.netlifyIdentity.on('signup', async user => {
        console.log('🎉 New user signup:', user.email);
        console.log('📍 Current page:', window.location.pathname);
        
        // Setup 3-day Engage trial for new users
        try {
          console.log('🎁 Setting up 3-day Engage trial...');
          const trialResponse = await fetch('/.netlify/functions/setup-trial', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              user_email: user.email,
              user_uid: user.id
            })
          });
          
          if (trialResponse.ok) {
            const trialData = await trialResponse.json();
            console.log('✅ Trial setup successful:', trialData);
            
            // Store trial info in localStorage
            localStorage.setItem('user_plan', 'Engage');
            localStorage.setItem('subscription_status', 'trial');
            localStorage.setItem('trial_end_date', trialData['grace_period_end']);
            
            showNotification('🎉 Welcome! You have 3 days of Engage plan access with unlimited messaging!');
          } else {
            console.error('❌ Failed to setup trial');
          }
        } catch (error) {
          console.error('❌ Error setting up trial:', error);
        }
        
        updateLoginButton();
        window.netlifyIdentity.close();
        checkAuthAndLoadChats();
      });

      window.netlifyIdentity.on('logout', () => {
        updateLoginButton();
        showNotLoggedIn();
      });
    }

    function openNetlifyLogin() {
      if (window.netlifyIdentity) {
        localStorage.setItem('login_redirect_url', window.location.href);
        window.location.href = '/profile';
      } else {
        console.error('Netlify Identity not loaded');
        showError('Login system not available. Please try again later.', 'Login Error');
      }
    }

    // ===== NETLIFY IDENTITY BUTTON UPDATES =====
    function updateLoginButton() {
      const loginBtn = document.getElementById('loginBtn');
      const mobileLoginBtn = document.getElementById('mobileLoginBtn');
      
      // Check both Netlify Identity and local storage for user info
      const netlifyUser = window.netlifyIdentity && window.netlifyIdentity.currentUser();
      const localEmail = localStorage.getItem("user_email");
      const localToken = localStorage.getItem("user_token");
      
      let isAnonymousUser = localStorage.getItem('is_anonymous_user') === 'true';
      const isAnonymousEmail = localEmail === 'anonymous@narrin.ai';
      
      // FIX: Clear anonymous flag for real users with non-anonymous email
      if (isAnonymousUser && localEmail && localEmail !== 'anonymous@narrin.ai') {
        console.log('🔧 FIX: Clearing anonymous flag for real user on chat-overview:', localEmail);
        localStorage.removeItem('is_anonymous_user');
        isAnonymousUser = false;
      }
      
      const isLoggedIn = netlifyUser || (localEmail && localToken && !isAnonymousUser && !isAnonymousEmail);
      
      console.log('🔍 updateLoginButton debug:', {
        netlifyUser: !!netlifyUser,
        localEmail: !!localEmail,
        localToken: !!localToken,
        isLoggedIn
      });
      
      if (isLoggedIn) {
        // Always show "Profile" for logged in users instead of their name
        
        // Update desktop button
        if (loginBtn) {
          loginBtn.textContent = 'Profile';
          loginBtn.href = '/profile';
        }
        
        // Update mobile button
        if (mobileLoginBtn) {
          const icon = mobileLoginBtn.querySelector('.mobile-menu-link-icon');
          mobileLoginBtn.innerHTML = `${icon ? icon.outerHTML : '<span class="mobile-menu-link-icon">👤</span>'}Profile`;
          mobileLoginBtn.href = '/profile';
        }
      } else {
        // User is not logged in
        if (loginBtn) {
          loginBtn.textContent = 'Login/Register';
          loginBtn.href = '#';
          // Remove existing listeners by cloning element
          const newLoginBtn = loginBtn.cloneNode(true);
          loginBtn.parentNode.replaceChild(newLoginBtn, loginBtn);
          newLoginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (window.netlifyIdentity) {
              window.netlifyIdentity.open();
            }
          });
        }
        if (mobileLoginBtn) {
          const icon = mobileLoginBtn.querySelector('.mobile-menu-link-icon');
          mobileLoginBtn.innerHTML = `${icon ? icon.outerHTML : '<span class="mobile-menu-link-icon">👤</span>'}Login/Register`;
          mobileLoginBtn.href = '#';
          // Remove existing listeners by cloning element
          const newMobileLoginBtn = mobileLoginBtn.cloneNode(true);
          mobileLoginBtn.parentNode.replaceChild(newMobileLoginBtn, mobileLoginBtn);
          // Re-add the innerHTML after cloning
          const newIcon = newMobileLoginBtn.querySelector('.mobile-menu-link-icon');
          newMobileLoginBtn.innerHTML = `${newIcon ? newIcon.outerHTML : '<span class="mobile-menu-link-icon">👤</span>'}Login/Register`;
          newMobileLoginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (window.netlifyIdentity) {
              window.netlifyIdentity.open();
            }
          });
        }
      }
    }

    // Enhanced click handler for navigation links
    function setupNavigationClickHandlers() {
      const loginBtn = document.getElementById('loginBtn');
      const mobileLoginBtn = document.getElementById('mobileLoginBtn');
      
      // Desktop login button click handler
      if (loginBtn) {
        loginBtn.addEventListener('click', (e) => {
          e.preventDefault();
          
          const netlifyUser = window.netlifyIdentity && window.netlifyIdentity.currentUser();
          const localEmail = localStorage.getItem("user_email");
          const localToken = localStorage.getItem("user_token");
          let isAnonymousUser = localStorage.getItem('is_anonymous_user') === 'true';
      const isAnonymousEmail = localEmail === 'anonymous@narrin.ai';
      
      // FIX: Clear anonymous flag for real users  
      if (isAnonymousUser && localEmail && localEmail !== 'anonymous@narrin.ai') {
        localStorage.removeItem('is_anonymous_user');
        isAnonymousUser = false;
      }
      
      const isLoggedIn = netlifyUser || (localEmail && localToken && !isAnonymousUser && !isAnonymousEmail);
          
          if (isLoggedIn) {
            // User is logged in, go directly to profile page
            window.location.href = '/profile';
          } else {
            // User not logged in, store current page for redirect and open login
            localStorage.setItem('login_redirect_url', window.location.href);
            openLogin();
          }
        });
      }
      
      // Mobile login button click handler
      if (mobileLoginBtn) {
        mobileLoginBtn.addEventListener('click', (e) => {
          e.preventDefault();
          
          const netlifyUser = window.netlifyIdentity && window.netlifyIdentity.currentUser();
          const localEmail = localStorage.getItem("user_email");
          const localToken = localStorage.getItem("user_token");
          let isAnonymousUser = localStorage.getItem('is_anonymous_user') === 'true';
      const isAnonymousEmail = localEmail === 'anonymous@narrin.ai';
      
      // FIX: Clear anonymous flag for real users  
      if (isAnonymousUser && localEmail && localEmail !== 'anonymous@narrin.ai') {
        localStorage.removeItem('is_anonymous_user');
        isAnonymousUser = false;
      }
      
      const isLoggedIn = netlifyUser || (localEmail && localToken && !isAnonymousUser && !isAnonymousEmail);
          
          if (isLoggedIn) {
            // User is logged in, go directly to profile page
            window.location.href = '/profile';
          } else {
            // User not logged in, store current page for redirect and open login
            localStorage.setItem('login_redirect_url', window.location.href);
            openLogin();
          }
          
          // Close mobile menu after click
          closeMobileMenu();
        });
      }
    }

    // Function to open login modal
    function openLogin() {
      if (window.netlifyIdentity) {
        window.netlifyIdentity.open('login');
      } else {
        // Fallback if Netlify Identity is not available
        window.location.href = '/profile';
      }
    }

    // Check companion limits before allowing navigation
    // REMOVED: Companion limit check function - was blocking navigation
    /*
    async function checkCompanionLimitBeforeNavigation(e) {
      e.preventDefault();
      
      const email = localStorage.getItem('user_email');
      const uid = localStorage.getItem('user_uid');
      
      if (!email || !uid) {
        // Not logged in, allow navigation
        window.location.href = '/create-character';
        return;
      }
      
      try {
        // Get user's chat history to check active companions
        const chatHistoryResponse = await fetch(`/.netlify/functions/get-chat-history?user_id=${uid}`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('user_token')}`,
            'X-User-Email': email,
            'X-User-UID': uid
          }
        });
        
        if (chatHistoryResponse.ok) {
          const chatData = await chatHistoryResponse.json();
          if (chatData.success && chatData.chats) {
            // Get paused chats from localStorage
            const pausedChats = JSON.parse(localStorage.getItem('pausedChats') || '[]');
            
            // Count active companions
            const activeChats = chatData.chats.filter(chat => !pausedChats.includes(chat.character_slug));
            
            // Get user plan
            const userPlan = localStorage.getItem('user_plan') || 'Free';
            const maxActive = userPlan === 'Free' ? 3 : userPlan === 'Engage' ? 5 : Infinity;
            
            if (activeChats.length >= maxActive) {
              console.log(`⚠️ Active companion limit reached: ${activeChats.length}/${maxActive}`);
              
              // Show upgrade modal (assuming function exists globally)
              if (typeof showUpgradePrompt === 'function') {
                showUpgradePrompt(activeChats.length, maxActive, 'companions');
              } else {
                alert(`You have reached your companion limit (${activeChats.length}/${maxActive}). Please upgrade your plan to create more companions.`);
              }
              return;
            }
          }
        }
        
        // Allow navigation if under limit or if check fails
        window.location.href = '/create-character';
        
      } catch (error) {
        console.error('Error checking companion limits:', error);
        // Allow navigation on error
        window.location.href = '/create-character';
      }
    }
    */

    // Initialize login button on page load
    document.addEventListener('DOMContentLoaded', () => {
      // Wait for Netlify Identity to initialize before updating buttons
      setTimeout(() => {
        updateLoginButton();
      }, 200);
      
      // Add event listener for the not-logged-in login button
      const notLoggedInBtn = document.getElementById('notLoggedInBtn');
      if (notLoggedInBtn) {
        notLoggedInBtn.addEventListener('click', (e) => {
          e.preventDefault();
          if (window.netlifyIdentity) {
            window.netlifyIdentity.open();
          }
        });
      }
      
      // REMOVED: Companion limit check - was blocking navigation
      // const createCompanionLinks = document.querySelectorAll('a[href="/create-character"]');
      // createCompanionLinks.forEach(link => {
      //   link.addEventListener('click', checkCompanionLimitBeforeNavigation);
      // });
      
      // Set up click handlers
      setupNavigationClickHandlers();
      
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on('init', user => {
          updateLoginButton();
        });

        window.netlifyIdentity.on('login', user => {
          updateLoginButton();
          window.netlifyIdentity.close();
        });

        window.netlifyIdentity.on('logout', () => {
          updateLoginButton();
        });
      }
    });

    // Also update on window load as backup
    window.addEventListener('load', () => {
      setTimeout(() => {
        updateLoginButton();
      }, 300);
    });

    function checkAuthAndLoadChats() {
      const token = localStorage.getItem('user_token');
      const email = localStorage.getItem('user_email');
      const uid = localStorage.getItem('user_uid');
      const netlifyUser = window.netlifyIdentity && window.netlifyIdentity.currentUser();

      if ((token && email && uid) || netlifyUser) {
        console.log('✅ User is authenticated, loading chats');
        
        // Check trial status for authenticated users
        if (email && uid) {
          checkTrialStatus(email, uid);
        }
        
        loadUserChats();
      } else {
        console.log('❌ User not authenticated');
        showNotLoggedIn();
      }
    }

// UNIVERSELE Authentication Check - Voeg toe aan chat-overview.html
function initializeAuthenticationCheck() {
  const isMobile = /Mobile|Android|iPhone|iPad/.test(navigator.userAgent);
  console.log('🔐 Initializing authentication check...', { isMobile, userAgent: navigator.userAgent.substring(0, 50) });
  
  // Check localStorage first
  const token = localStorage.getItem('user_token');
  const email = localStorage.getItem('user_email');
  const uid = localStorage.getItem('user_uid');
  const timestamp = localStorage.getItem('user_auth_timestamp');
  
  console.log('🔑 localStorage auth data:', { 
    hasToken: !!token, 
    hasEmail: !!email, 
    hasUid: !!uid,
    tokenValue: token?.substring(0, 20) + '...',
    emailValue: email,
    uidValue: uid
  });
  
  if (token && email && uid && token !== 'false' && token !== 'null') {
    // Check if token is not too old (24 hours)
    const authAge = Date.now() - parseInt(timestamp || '0');
    if (authAge < 24 * 60 * 60 * 1000) {
      console.log('✅ Valid authentication found in localStorage:', email);
      
      // Set global auth state
      window.isAuthenticated = true;
      window.currentUser = { email, uid, token };
      
      // Update UI
      updateLoginButton();
      
      return true;
    } else {
      console.log('⏰ Authentication expired, clearing...');
      clearAuthData();
    }
  }
  
  // Fallback: Check Netlify Identity
  if (window.netlifyIdentity) {
    const netlifyUser = window.netlifyIdentity.currentUser();
    if (netlifyUser) {
      console.log('✅ Found Netlify Identity user:', netlifyUser.email);
      
      // Store authentication data
      const accessToken = netlifyUser.token?.access_token || netlifyUser.access_token;
      if (accessToken) {
        localStorage.setItem('user_email', netlifyUser.email);
        localStorage.setItem('user_token', accessToken);
        localStorage.setItem('user_uid', netlifyUser.id);
        localStorage.setItem('user_auth_timestamp', Date.now().toString());
        
        window.isAuthenticated = true;
        window.currentUser = { 
          email: netlifyUser.email, 
          uid: netlifyUser.id, 
          token: accessToken 
        };
        
        return true;
      }
    }
  }
  
  console.log('❌ No valid authentication found');
  window.isAuthenticated = false;
  window.currentUser = null;
  updateLoginButton();
  return false;
}

// Clear authentication data
function clearAuthData() {
  localStorage.removeItem('user_email');
  localStorage.removeItem('user_token');
  localStorage.removeItem('user_uid');
  localStorage.removeItem('user_auth_timestamp');
  localStorage.removeItem('user_refresh_token');
  localStorage.removeItem('user_netlify_data');
  
  window.isAuthenticated = false;
  window.currentUser = null;
}

   // GEFIXTE versie voor chat-overview.html
async function loadUserChats() {
  console.log('📡 Loading user chats...');
  
  // NIEUWE authentication check
  if (!window.isAuthenticated || !window.currentUser) {
    if (!initializeAuthenticationCheck()) {
      showNotLoggedIn();
      return;
    }
  }
  
  showLoading();
  
  try {
    const { email, token, uid } = window.currentUser;
    
    console.log('🔍 Loading chats - Auth check:', {
      hasToken: !!token,
      hasEmail: !!email,
      hasUid: !!uid,
      email: email
    });

    // Test of de function bestaat
    console.log('🔗 Testing function endpoint...');
    
    // Direct Airtable API via Netlify Function
    const functionUrl = '/.netlify/functions/get-user-chats';
    console.log('📡 Calling:', functionUrl);
    
    const response = await fetch(functionUrl, {
      method: 'POST',
      headers: { 
        'Content-Type': 'application/json',
        'Accept': 'application/json'
      },
      body: JSON.stringify({
        user_email: email,
        user_uid: uid,
        user_token: token
      })
    });

    console.log('📡 Function response:', {
      status: response.status,
      statusText: response.statusText,
      ok: response.ok,
      headers: Object.fromEntries(response.headers)
    });

    // Check voor verschillende error types
    if (response.status === 404) {
      console.error('❌ Function not found - mogelijk deployment issue');
      showError('Chat functie niet beschikbaar. Probeer pagina te verversen.');
      return;
    }
    
    if (response.status === 500) {
      console.error('❌ Server error - mogelijk environment variables');
      const errorText = await response.text();
      console.error('Server error details:', errorText);
      showError('Server configuratie probleem. Neem contact op met support.');
      return;
    }

    if (!response.ok) {
      const errorText = await response.text();
      console.error('❌ HTTP Error:', response.status, errorText);
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }

    const data = await response.json();
    console.log('✅ Function response data:', data);

    if (!data.success) {
      console.error('❌ API returned success: false:', data.error);
      throw new Error(data.error || 'API returned success: false');
    }

    // Process the chats data from Airtable
    userChats = data.chats || [];
    
    // Add paused state to chats
    const pausedChats = JSON.parse(localStorage.getItem('pausedChats') || '[]');
    userChats = userChats.map(chat => ({
      ...chat,
      isPaused: pausedChats.includes(chat.character_slug)
    }));
    
    console.log('✅ Chats loaded:', userChats.length, 'chats found');
    
    if (userChats.length > 0) {
      console.log('📊 Sample chat:', userChats[0]);
    }

    displayChats();

  } catch (error) {
    console.error('❌ Error loading chats:', error);
    
    // Specifieke error handling
    if (error.message.includes('Failed to fetch')) {
      showError('Netwerkprobleem. Check je internetverbinding en probeer opnieuw.');
    } else if (error.message.includes('404')) {
      showError('Chat functie niet gevonden. Mogelijk deployment probleem.');
    } else if (error.message.includes('500')) {
      showError('Server configuratie probleem. Neem contact op met support.');
    } else {
      showError(`Fout bij laden van chats: ${error.message}`);
    }
    
    // Fallback naar sample chats voor demo
    console.log('🎭 Showing sample chats as fallback');
    showSampleChats();
  }
}

// Helper functie voor avatar URL extractie
function extractAvatarUrl(chat) {
  // Airtable attachment format
  if (chat.avatar_url && Array.isArray(chat.avatar_url) && chat.avatar_url.length > 0) {
    return chat.avatar_url[0].url || null;
  }
  
  if (chat.Avatar_URL && Array.isArray(chat.Avatar_URL) && chat.Avatar_URL.length > 0) {
    return chat.Avatar_URL[0].url || null;
  }
  
  // Direct string format
  if (chat.avatar_url && typeof chat.avatar_url === 'string' && chat.avatar_url.startsWith('http')) {
    return chat.avatar_url;
  }
  
  if (chat.Avatar_URL && typeof chat.Avatar_URL === 'string' && chat.Avatar_URL.startsWith('http')) {
    return chat.Avatar_URL;
  }
  
  return null;
}

    // Retry functie voor netwerkverzoeken
    async function fetchWithRetry(url, options, retries = 3) {
      for (let i = 0; i < retries; i++) {
        try {
          const response = await fetch(url, options);
          if (response.ok) {
            return response;
          }
          if (i === retries - 1) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          console.log(`⚠️ Retry ${i + 1}/${retries} - HTTP ${response.status}`);
          await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1))); // Exponential backoff
        } catch (error) {
          if (i === retries - 1) {
            throw error;
          }
          console.log(`⚠️ Retry ${i + 1}/${retries} - ${error.message}`);
          await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
        }
      }
    }

    // Behoud de helper functies
    function parseDateForSorting(dateString) {
      if (!dateString || dateString === 'Never') return new Date(0);
      
      if (dateString.includes('ago')) {
        const now = new Date();
        if (dateString.includes('minutes')) {
          const minutes = parseInt(dateString);
          return new Date(now.getTime() - (minutes * 60 * 1000));
        }
        if (dateString.includes('hours')) {
          const hours = parseInt(dateString);
          return new Date(now.getTime() - (hours * 60 * 60 * 1000));
        }
        if (dateString.includes('days')) {
          const days = parseInt(dateString);
          return new Date(now.getTime() - (days * 24 * 60 * 60 * 1000));
        }
      }
      
      try {
        return new Date(dateString);
      } catch (e) {
        return new Date(0);
      }
    }

   function formatChatDate(timestamp) {
  if (!timestamp || timestamp === 'Never') return 'Never';
  
  try {
    const date = new Date(timestamp);
    
    // Check if valid date
    if (isNaN(date.getTime())) {
      return 'Unknown';
    }
    
    const now = new Date();
    const diffTime = now - date;
    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
    const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
    const diffMinutes = Math.floor(diffTime / (1000 * 60));
    
    // Relative time formatting
    if (diffMinutes < 60) {
      return diffMinutes <= 1 ? 'Just now' : `${diffMinutes} minutes ago`;
    } else if (diffHours < 24) {
      return diffHours === 1 ? '1 hour ago' : `${diffHours} hours ago`;
    } else if (diffDays < 7) {
      return diffDays === 1 ? 'Yesterday' : `${diffDays} days ago`;
    } else {
      return date.toLocaleDateString('en-GB', { 
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
      });
    }
  } catch (e) {
    console.error('Date formatting error:', e);
    return 'Unknown';
  }
}

    function showSampleChats() {
      console.log('🎭 Showing sample chats due to API error');
      // Sample data for demonstration - MEER CHATS VOOR DEMO
      userChats = [
        {
          character_name: "Albert Einstein",
          character_title: "Theoretical Physicist",
          character_slug: "albert-einstein",
          avatar_url: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",
          last_message: "The important thing is not to stop questioning. Curiosity has its own reason for existing. What would you like to explore today?",
          last_message_date: "2 hours ago",
          message_count: 12
        },
        {
          character_name: "Marie Curie",
          character_title: "Scientist & Nobel Laureate",
          character_slug: "marie-curie",
          avatar_url: "https://images.unsplash.com/photo-1494790108755-2616b612b631?w=150&h=150&fit=crop&crop=face",
          last_message: "In science, we must be interested in things, not in persons. Tell me about your latest discoveries.",
          last_message_date: "4 hours ago",
          message_count: 8
        },
        {
          character_name: "Leonardo da Vinci",
          character_title: "Renaissance Genius",
          character_slug: "leonardo-da-vinci",
          avatar_url: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",
          last_message: "Learning never exhausts the mind. Art is never finished, only abandoned. Shall we create something beautiful together?",
          last_message_date: "Yesterday",
          message_count: 24
        },
        {
          character_name: "Socrates",
          character_title: "Ancient Greek Philosopher",
          character_slug: "socrates",
          avatar_url: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",
          last_message: "The only true wisdom is in knowing you know nothing. What questions shall we explore through dialogue?",
          last_message_date: "2 days ago",
          message_count: 15
        },
        {
          character_name: "Frida Kahlo",
          character_title: "Artist & Icon",
          character_slug: "frida-kahlo",
          avatar_url: "https://images.unsplash.com/photo-1494790108755-2616b612b631?w=150&h=150&fit=crop&crop=face",
          last_message: "I paint my own reality. The thing is to know how to look. Let's discuss art, life, and passion!",
          last_message_date: "3 days ago",
          message_count: 6
        },
        {
          character_name: "Nikola Tesla",
          character_title: "Inventor & Electrical Engineer",
          character_slug: "nikola-tesla",
          avatar_url: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",
          last_message: "The present is theirs; the future, for which I really worked, is mine. What innovations shall we dream up?",
          last_message_date: "1 week ago",
          message_count: 18
        }
      ];
      
      displayChats();
    }

    function displayChats() {
      console.log('🎨 displayChats() called with userChats:', userChats);
  console.log('🎨 userChats length:', userChats.length);
  console.log('🎨 First chat details:', userChats[0]);

      hideLoading();
      showMainContent();

      const chatsGrid = document.getElementById('chatsGrid');
      const emptyState = document.getElementById('emptyState');

      // Filter out removed platform companions
      const removedCompanions = JSON.parse(localStorage.getItem('removedCompanions') || '[]');
      console.log('🗂️ Current removedCompanions from localStorage:', removedCompanions);
      
      const filteredChats = userChats.filter(chat => {
        const isRemoved = removedCompanions.includes(chat.character_slug);
        if (isRemoved) {
          console.log('🙈 Filtering out removed companion:', chat.character_slug);
        }
        return !isRemoved;
      });
      
      console.log('🔍 Filtered chats:', { 
        original: userChats.length, 
        filtered: filteredChats.length, 
        removed: removedCompanions,
        slugsInChats: userChats.map(c => c.character_slug).slice(0, 5)
      });
      
      // Update companion status counter with filtered chats
      updateCompanionStatusCounter(filteredChats);

      console.log('🎨 Displaying chats:', filteredChats.length);

      if (filteredChats.length === 0) {
        chatsGrid.style.display = 'none';
        emptyState.style.display = 'block';
        return;
      }

      chatsGrid.style.display = 'grid';
      emptyState.style.display = 'none';
      chatsGrid.innerHTML = '';

      // Sort chats: active first, then paused
      const sortedChats = [...filteredChats].sort((a, b) => {
        // Active chats come first
        if (!a.isPaused && b.isPaused) return -1;
        if (a.isPaused && !b.isPaused) return 1;
        // Within the same status, keep original order (or sort by last message date)
        return 0;
      });

      sortedChats.forEach(chat => {
        const chatCard = createChatCard(chat);
        chatsGrid.appendChild(chatCard);
      });

      // Add centering class if there are 2 or fewer companions
      if (sortedChats.length <= 2) {
        chatsGrid.classList.add('center-few');
      } else {
        chatsGrid.classList.remove('center-few');
      }
    }

   function createChatCard(chat) {
  console.log('🃏 Creating card for chat:', chat);
  
  const card = document.createElement('a');
  card.className = chat.isPaused ? 'chat-card paused' : 'chat-card';
  card.href = `chat.html?char=${chat.character_slug}`;
  card.setAttribute('data-companion-slug', chat.character_slug);
  // Companion limit removed - direct navigation allowed
  
  // Extract avatar URL using helper function
  const avatarUrl = extractAvatarUrl(chat);
  
  // Verbeterde avatar handling
  const avatarContent = avatarUrl 
    ? `<img src="${avatarUrl}" alt="${chat.character_name}" onerror="this.parentElement.innerHTML='👤'" loading="lazy">`
    : '👤';

  // Filter out debug/memory messages from preview
  function isDebugMessage(message) {
    if (!message) return false;
    
    return message.startsWith('Processing message') ||
           message.startsWith('Final extracted') ||
           message.startsWith('🧹 Filtering out debug/system message:') ||
           message.includes('Vorige gesprekken en belangrijke informatie:') ||
           message.includes('[Belangrijk geheugen (') ||
           message.includes('Gebruik deze informatie om persoonlijk te antwoorden') ||
           message.includes('what are you doing?]') && message.includes('[Belangrijk geheugen') ||
           message.includes('whats on your mind?]') && message.includes('[Belangrijk geheugen') ||
           message.includes('how is your day?]') && message.includes('[Belangrijk geheugen') ||
           message.includes('[Onboarding Information') ||
           message.includes('[User Onboarding') ||
           message.includes('Life Phase:') ||
           message.includes('Focus Area:') ||
           message.includes('Relationship Status:') ||
           message.includes('Career Stage:') ||
           message.includes('Business Stage:') ||
           message.includes('Mindfulness Experience:') ||
           message.includes('Friendship Situation:') ||
           (message.startsWith('{') && message.endsWith('}') && message.includes('"role"') && message.includes('"message"')) ||
           /^rec[A-Za-z0-9]{14}$/.test(message.trim()) ||
           (message.length > 500 && message.includes('[Belangrijk geheugen'));
  }

  // Korte preview text (max 120 karakters) - filter out debug messages
  const cleanMessage = chat.last_message && !isDebugMessage(chat.last_message) ? chat.last_message : '';
  const previewText = cleanMessage 
    ? (cleanMessage.length > 120 ? cleanMessage.substring(0, 120) + '...' : cleanMessage)
    : 'Start a new conversation...';

  card.innerHTML = `
    <div class="chat-header">
      <div class="chat-avatar">${avatarContent}</div>
      <div class="chat-info">
        <h3 class="chat-name">${chat.character_name || 'Unknown Character'}</h3>
        <p class="chat-title">${chat.character_title || 'AI Character'}</p>
      </div>
    </div>
    <div class="chat-preview">${previewText}</div>
    <div class="chat-meta">
      <span class="chat-date">${formatChatDate(chat.last_message_date)}</span>
    </div>
    <div class="chat-actions-container" onclick="event.preventDefault(); event.stopPropagation();" style="
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
    ">
      <button class="delete-companion-btn" onclick="event.preventDefault(); event.stopPropagation(); deleteCompanion('${chat.character_slug}', '${(chat.character_name || 'Unknown Character').replace(/'/g, "\\'")}', event)" style="
        background: #fee2e2;
        color: #dc2626;
        border: 1px solid #fca5a5;
        border-radius: 8px;
        padding: 8px 16px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
      " title="Delete companion permanently">
        🗑️ Delete
      </button>
    </div>
  `;

  return card;
}

    // Pause/unpause character functionality
    function togglePauseChat(characterSlug, characterName, isPaused) {
      // Create modal if it doesn't exist
      let modal = document.getElementById('deleteModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'deleteModal';
        modal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.8);
          z-index: 10000;
          display: flex;
          align-items: center;
          justify-content: center;
          opacity: 0;
          transition: opacity 0.3s ease;
        `;
        
        modal.innerHTML = `
          <div style="
            background: white;
            border-radius: 16px;
            padding: 32px;
            max-width: 480px;
            width: 90%;
            text-align: center;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
          " id="deleteModalContent">
            <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(135deg, #ef4444 0%, #f97316 100%);"></div>
            
            <div style="margin-bottom: 24px;">
              <div style="font-size: 48px; margin-bottom: 16px;">🗑️</div>
              <h3 style="font-size: 24px; font-weight: 700; color: #0f172a; margin: 0 0 8px 0;">Delete Companion</h3>
              <p style="color: #64748b; line-height: 1.6; margin-bottom: 20px;">
                Are you sure you want to delete <strong id="characterNameToDelete"></strong>?
              </p>
              
              <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 12px; padding: 16px; margin-bottom: 20px; text-align: left;">
                <p style="color: #991b1b; font-weight: 600; margin: 0 0 8px 0; font-size: 14px;">This will:</p>
                <ul style="list-style: none; padding: 0; margin: 0;">
                  <li style="color: #7f1d1d; padding: 4px 0; font-size: 14px;">• Remove the companion from your account</li>
                  <li style="color: #7f1d1d; padding: 4px 0; font-size: 14px;">• Clear local conversation history</li>
                </ul>
                <p style="color: #059669; font-size: 13px; margin-top: 12px; padding-top: 12px; border-top: 1px solid #fecaca;">
                  ✓ Your memories will be preserved for future use
                </p>
              </div>
              
              <p style="color: #ef4444; font-weight: 600; font-size: 14px;">This action cannot be undone.</p>
            </div>
            
            <div style="display: flex; gap: 12px;">
              <button onclick="executeDelete()" style="
                flex: 1;
                padding: 12px 20px;
                background: #ef4444;
                color: white;
                border: none;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.3s;
              " onmouseover="this.style.backgroundColor='#dc2626'" onmouseout="this.style.backgroundColor='#ef4444'">
                Delete Companion
              </button>
              <button onclick="closeDeleteModal()" style="
                flex: 1;
                padding: 12px 20px;
                background: #e2e8f0;
                color: #475569;
                border: none;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.3s;
              " onmouseover="this.style.backgroundColor='#cbd5e1'" onmouseout="this.style.backgroundColor='#e2e8f0'">
                Cancel
              </button>
            </div>
          </div>
        `;
        
        document.body.appendChild(modal);
      }
      
      // Store the character slug for deletion
      window.characterToDelete = characterSlug;
      
      // Update character name in modal
      document.getElementById('characterNameToDelete').textContent = characterName;
      
      // Show modal with animation
      modal.style.display = 'flex';
      setTimeout(() => {
        modal.style.opacity = '1';
        document.getElementById('deleteModalContent').style.transform = 'scale(1)';
      }, 10);
    }
    
    // New pause toggle function
    function togglePauseChat(characterSlug, characterName, isPaused, event) {
      try {
        // Get current paused chats
        let pausedChats = JSON.parse(localStorage.getItem('pausedChats') || '[]');
        
        // Check active companion limits before unpausing
        if (isPaused) {
          // Trying to unpause (activate) a companion
          const userPlan = localStorage.getItem('user_plan') || 'Free';
          const activeCount = userChats.filter(c => !c.isPaused && c.character_slug !== characterSlug).length;
          
          let maxActive = userPlan === 'Free' ? 3 : userPlan === 'Engage' ? 5 : Infinity;
          
          if (activeCount >= maxActive) {
            // Show upgrade modal using global function
            window.showUpgradePrompt(activeCount, maxActive, 'companions');
            return;
          }
          
          // Remove from paused list (activate)
          pausedChats = pausedChats.filter(slug => slug !== characterSlug);
        } else {
          // Pausing a companion
          if (!pausedChats.includes(characterSlug)) {
            pausedChats.push(characterSlug);
          }
        }
        
        // Save updated paused list
        localStorage.setItem('pausedChats', JSON.stringify(pausedChats));
        
        // Animate the toggle before reload
        const toggleBtn = event.target.closest('.pause-toggle-btn');
        if (toggleBtn) {
          const toggleDot = toggleBtn.querySelector('div');
          if (toggleDot) {
            // Animate the toggle
            if (isPaused) {
              // Moving from right to left (unpausing/activating)
              toggleDot.style.left = '3px';
              toggleDot.style.right = 'auto';
              toggleBtn.style.background = 'linear-gradient(135deg, #14b8a6 0%, #f97316 100%)';
              toggleBtn.style.border = 'none';
            } else {
              // Moving from left to right (pausing)
              toggleDot.style.left = 'auto';
              toggleDot.style.right = '3px';
              toggleBtn.style.background = '#fee2e2';
              toggleBtn.style.border = '1px solid #fca5a5';
            }
            
            // Wait for animation to complete before reload
            setTimeout(() => {
              window.location.reload();
            }, 300);
          } else {
            // No animation element found, reload immediately
            window.location.reload();
          }
        } else {
          // No button found, reload immediately
          window.location.reload();
        }
      } catch (error) {
        console.error('Error toggling pause state:', error);
        alert('An error occurred. Please try again.');
      }
    }
    
    // DEPRECATED: This function is no longer used - replaced by global showUpgradePrompt
    function showPauseLimitModal_DEPRECATED(userPlan, maxActive) {
      let modal = document.getElementById('pauseLimitModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'pauseLimitModal';
        modal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.8);
          z-index: 10000;
          display: flex;
          align-items: center;
          justify-content: center;
        `;
        
        document.body.appendChild(modal);
      }
      
      modal.innerHTML = `
        <div style="
          background: white;
          border-radius: 16px;
          padding: 32px;
          max-width: 500px;
          width: 90%;
          text-align: center;
          position: relative;
        ">
          <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(135deg, #14b8a6 0%, #f97316 100%);"></div>
          
          <div style="margin-bottom: 24px;">
            <div style="font-size: 48px; margin-bottom: 16px;">💎</div>
            <h3 style="font-size: 24px; font-weight: 700; color: #0f172a; margin: 0 0 8px 0;">Active Companion Limit</h3>
            <p style="color: #64748b; line-height: 1.6;">
              You've reached your limit of <strong>${maxActive} active companions</strong> on the ${userPlan} plan.
              <br><br>
              To activate this companion, you need to pause another one first, or upgrade your plan.
            </p>
          </div>
          
          <div style="background: #f8fafc; border-radius: 12px; padding: 20px; margin-bottom: 24px; text-align: left;">
            <div style="display: flex; align-items: center; padding: 8px 0;">
              <span style="font-size: 20px; margin-right: 12px;">✨</span>
              <span style="color: #475569;">Free: 3 active companions</span>
            </div>
            <div style="display: flex; align-items: center; padding: 8px 0;">
              <span style="font-size: 20px; margin-right: 12px;">🎯</span>
              <span style="color: #475569;">Engage: 5 active companions</span>
            </div>
            <div style="display: flex; align-items: center; padding: 8px 0;">
              <span style="font-size: 20px; margin-right: 12px;">🚀</span>
              <span style="color: #475569; font-weight: 600;">Immerse: Unlimited active companions</span>
            </div>
          </div>
          
          <div style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.05) 0%, rgba(249, 115, 22, 0.05) 100%); border: 1px solid rgba(20, 184, 166, 0.2); border-radius: 12px; padding: 16px; margin-bottom: 24px; text-align: left;">
            <h4 style="color: #0f172a; font-size: 14px; font-weight: 600; margin: 0 0 12px 0;">✨ Immerse Plan Benefits:</h4>
            <div style="display: grid; gap: 8px; font-size: 13px; color: #475569;">
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">♾️</span>
                <span>Unlimited active companions</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">💬</span>
                <span>Unlimited messages per day</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">🎙️</span>
                <span>Voice chat (text-to-speech & speech-to-text)</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">🧠</span>
                <span>Advanced memory & deeper personalization</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">⚡</span>
                <span>Priority response speed</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">🎨</span>
                <span>Custom avatars & character creation</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">🔐</span>
                <span>Private companions & enhanced privacy</span>
              </div>
              <div style="display: flex; align-items: flex-start;">
                <span style="margin-right: 8px;">💫</span>
                <span>Early access to new features</span>
              </div>
            </div>
          </div>
          
          <div style="display: flex; gap: 12px;">
            <button onclick="window.location.href='profile.html#plans'" style="
              flex: 1;
              padding: 12px 20px;
              background: linear-gradient(135deg, #14b8a6 0%, #f97316 100%);
              color: white;
              border: none;
              border-radius: 8px;
              font-weight: 600;
              cursor: pointer;
            ">
              View Plans
            </button>
            <button onclick="document.getElementById('pauseLimitModal').style.display='none'" style="
              flex: 1;
              padding: 12px 20px;
              background: #e2e8f0;
              color: #475569;
              border: none;
              border-radius: 8px;
              font-weight: 600;
              cursor: pointer;
            ">
              Not Now
            </button>
          </div>
        </div>
      `;
      
      modal.style.display = 'flex';
    }
    
    function closeDeleteModal() {
      const modal = document.getElementById('deleteModal');
      if (modal) {
        modal.style.opacity = '0';
        document.getElementById('deleteModalContent').style.transform = 'scale(0.9)';
        setTimeout(() => {
          modal.style.display = 'none';
        }, 300);
      }
    }
    
    function executeDelete() {
      if (window.characterToDelete) {
        deleteChat(window.characterToDelete);
        closeDeleteModal();
      }
    }
    
    async function deleteChat(characterSlug) {
      try {
        const userEmail = localStorage.getItem('user_email');
        const userUid = localStorage.getItem('user_uid');
        const userToken = localStorage.getItem('user_token');
        
        if (!userEmail || !userUid || !userToken) {
          alert('You must be logged in to delete characters.');
          return;
        }
        
        // For user-created characters, remove from localStorage and hide
        console.log('🗑️ Removing user-created character locally');
        
        // Add to removed companions list
        let removedCompanions = JSON.parse(localStorage.getItem('removedCompanions') || '[]');
        if (!removedCompanions.includes(characterSlug)) {
          removedCompanions.push(characterSlug);
          localStorage.setItem('removedCompanions', JSON.stringify(removedCompanions));
        }
        
        // Always treat as successful for local removal
        if (true) {
          // Remove chat history from local storage (but keep memories in Airtable)
          localStorage.removeItem(`chat_history_${characterSlug}`);
          
          // Remove customization if exists
          const customizations = JSON.parse(localStorage.getItem('characterCustomizations') || '{}');
          delete customizations[characterSlug];
          localStorage.setItem('characterCustomizations', JSON.stringify(customizations));
          
          // Reload the page to refresh the chat list
          alert('Character deleted successfully.');
          window.location.reload();
        } else {
          alert('Failed to delete character. Please try again.');
        }
      } catch (error) {
        console.error('Error deleting character:', error);
        alert('An error occurred while deleting the character. Please try again.');
      }
    }

    // Update free plan status
    function updateCompanionStatusCounter(chatsToCount = userChats) {
      const planLimitInfo = document.getElementById('planLimitInfo');
      if (!planLimitInfo) return;
      
      // Companion limits removed - always show unlimited
      const userPlan = localStorage.getItem('user_plan') || 'Free';
      
      // Show unlimited for all plans
      planLimitInfo.innerHTML = `${userPlan} Plan`;
      planLimitInfo.style.background = 'white';
      planLimitInfo.style.color = '#0f172a';
      
      // Show the free plan status
      const freePlanStatus = document.getElementById('freePlanStatus');
      if (freePlanStatus) {
        freePlanStatus.style.display = 'flex';
      }
    }

    // UI State Functions
    function showLoading() {
      document.getElementById('loadingState').style.display = 'block';
      document.getElementById('errorState').style.display = 'none';
      document.getElementById('notLoggedIn').style.display = 'none';
      document.getElementById('mainContent').style.display = 'none';
    }

    function hideLoading() {
      document.getElementById('loadingState').style.display = 'none';
    }

    function showError(message) {
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('errorState').style.display = 'block';
      document.getElementById('notLoggedIn').style.display = 'none';
      document.getElementById('mainContent').style.display = 'none';
      
      const errorState = document.getElementById('errorState');
      errorState.querySelector('p').textContent = message;
    }

    function showNotLoggedIn() {
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('errorState').style.display = 'none';
      document.getElementById('notLoggedIn').style.display = 'block';
      document.getElementById('mainContent').style.display = 'none';
    }

    function showMainContent() {
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('errorState').style.display = 'none';
      document.getElementById('notLoggedIn').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
    }

// ===== SAFARI COMPATIBILITY CHECK =====
    function checkLocalStorageSupport() {
      try {
        const test = 'localStorage-test';
        localStorage.setItem(test, test);
        localStorage.removeItem(test);
        console.log('✅ localStorage werkt normaal');
        return true;
      } catch (e) {
        console.error('❌ localStorage NIET beschikbaar:', e);
        showError('Safari privacy instellingen blokkeren lokale opslag. Schakel "Prevent Cross-Site Tracking" uit in Safari instellingen.', 'Safari Compatibility Issue');
        return false;
      }
    }

    // Safari iOS fix voor cross-site requests
    function setupSafariFixes() {
      if (/Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent)) {
        console.log('🍎 Safari detected, applying fixes...');
        
        // Force credentials for all requests
        const originalFetch = window.fetch;
        window.fetch = function(url, options = {}) {
          options.credentials = options.credentials || 'same-origin';
          options.mode = options.mode || 'cors';
          return originalFetch(url, options);
        };
        
        // Check private browsing
        try {
          localStorage.setItem('safari-test', '1');
          localStorage.removeItem('safari-test');
        } catch (e) {
          if (e.name === 'QuotaExceededError') {
            showError('Safari Private Browsing detected. Some features may not work properly. Please use regular browsing mode.', 'Safari Compatibility');
          }
        }
      }
    }

    function runSafariCompatibilityTest() {
      const results = {
        localStorage: false,
        sessionStorage: false,
        cookies: false,
        fetch: false
      };
      
      // Test localStorage
      try {
        localStorage.setItem('test', 'value');
        localStorage.removeItem('test');
        results.localStorage = true;
      } catch (e) {
        console.error('localStorage test failed:', e);
      }
      
      // Test sessionStorage
      try {
        sessionStorage.setItem('test', 'value');
        sessionStorage.removeItem('test');
        results.sessionStorage = true;
      } catch (e) {
        console.error('sessionStorage test failed:', e);
      }
      
      // Test cookies
      results.cookies = navigator.cookieEnabled;
      
      // Test fetch
      results.fetch = typeof fetch !== 'undefined';
      
      console.log('🔍 Safari Compatibility Results:', results);
      
      if (!results.localStorage || !results.sessionStorage) {
        showError(`Safari compatibility issue detected. Please check your Safari privacy settings and disable "Prevent Cross-Site Tracking".`, 'Browser Compatibility');
      }
      
      return results;
    }

// Check trial status and handle expiration
async function checkTrialStatus(email, uid) {
  try {
    const response = await fetch('/.netlify/functions/check-trial', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ user_email: email, user_uid: uid })
    });
    
    if (response.ok) {
      const data = await response.json();
      
      if (data.trial_expired) {
        console.log('⏰ Trial has expired, updating localStorage');
        localStorage.setItem('user_plan', 'Free');
        localStorage.setItem('subscription_status', 'expired_trial');
        localStorage.removeItem('trial_end_date');
        
        // Show notification about trial expiration
        showNotification('⏰ Your 3-day Engage trial has ended. Upgrade to continue with unlimited messaging!');
      } else if (data.current_plan === 'Engage' && data.subscription_status === 'trial') {
        // Update localStorage with current trial info
        localStorage.setItem('user_plan', 'Engage');
        localStorage.setItem('subscription_status', 'trial');
        if (data['grace_period_end']) {
          localStorage.setItem('trial_end_date', data['grace_period_end']);
        }
      }
    }
  } catch (error) {
    console.error('❌ Error checking trial status:', error);
  }
}

// ===== DELETE COMPANION FUNCTIONALITY (CLEANED UP) =====

// Custom styled confirmation dialog
function showDeleteConfirmation(companionName, isPlatformCharacter) {
  return new Promise((resolve) => {
    // Create modal overlay
    const overlay = document.createElement('div');
    overlay.className = 'delete-modal-overlay';
    
    const actionText = isPlatformCharacter ? 'Remove' : 'Delete';
    const actionDescription = isPlatformCharacter 
      ? 'This companion will be removed from your companions list.'
      : 'This will completely remove your custom companion from the platform.';
    
    overlay.innerHTML = `
      <div class="delete-modal">
        <div class="delete-modal-header">
          <div class="delete-modal-icon">🗑️</div>
          <h3>${actionText} Companion</h3>
        </div>
        <div class="delete-modal-body">
          <p class="delete-question">${actionText} "<strong>${companionName}</strong>"?</p>
          <p class="delete-description">${actionDescription}</p>
          <p class="delete-note">Chat history will be preserved for your records.</p>
        </div>
        <div class="delete-modal-actions">
          <button class="delete-btn cancel" id="deleteCancel">Cancel</button>
          <button class="delete-btn confirm" id="deleteConfirm">${actionText}</button>
        </div>
      </div>
    `;
    
    // Add styling
    const style = document.createElement('style');
    style.textContent = `
      .delete-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(30, 41, 59, 0.95);
        backdrop-filter: blur(20px);
        z-index: 999999999;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: all 0.3s ease;
      }
      .delete-modal-overlay.active {
        opacity: 1;
      }
      .delete-modal {
        background: var(--color-white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-2xl);
        box-shadow: var(--shadow-xl);
        max-width: 420px;
        width: 90%;
        transform: scale(0.9);
        transition: all 0.3s ease;
      }
      .delete-modal-overlay.active .delete-modal {
        transform: scale(1);
      }
      .delete-modal-header {
        text-align: center;
        margin-bottom: var(--spacing-xl);
      }
      .delete-modal-icon {
        font-size: 48px;
        margin-bottom: var(--spacing-md);
      }
      .delete-modal-header h3 {
        margin: 0;
        color: var(--color-navy);
        font-family: var(--font-secondary);
        font-weight: 700;
        font-size: var(--font-size-xl);
      }
      .delete-modal-body {
        text-align: center;
        margin-bottom: var(--spacing-xl);
      }
      .delete-question {
        font-size: var(--font-size-base);
        color: var(--color-navy);
        margin: 0 0 var(--spacing-md) 0;
        line-height: 1.5;
      }
      .delete-description {
        font-size: var(--font-size-sm);
        color: var(--color-gray-dark);
        margin: 0 0 var(--spacing-sm) 0;
        line-height: 1.5;
      }
      .delete-note {
        font-size: var(--font-size-xs);
        color: var(--color-gray);
        margin: 0;
        font-style: italic;
      }
      .delete-modal-actions {
        display: flex;
        gap: var(--spacing-md);
        justify-content: center;
      }
      .delete-btn {
        padding: var(--spacing-md) var(--spacing-xl);
        border-radius: var(--radius-md);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        font-size: var(--font-size-sm);
        min-width: 100px;
        font-family: var(--font-primary);
      }
      .delete-btn.cancel {
        background: var(--color-light-gray);
        color: var(--color-gray-dark);
      }
      .delete-btn.cancel:hover {
        background: var(--color-gray-light);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }
      .delete-btn.confirm {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: var(--color-white);
      }
      .delete-btn.confirm:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
      }
    `;
    
    document.head.appendChild(style);
    document.body.appendChild(overlay);
    
    // Show modal with animation
    setTimeout(() => overlay.classList.add('active'), 10);
    
    // Event handlers
    document.getElementById('deleteCancel').addEventListener('click', () => {
      overlay.classList.remove('active');
      setTimeout(() => {
        document.body.removeChild(overlay);
        document.head.removeChild(style);
        resolve(false);
      }, 300);
    });
    
    document.getElementById('deleteConfirm').addEventListener('click', () => {
      overlay.classList.remove('active');
      setTimeout(() => {
        document.body.removeChild(overlay);
        document.head.removeChild(style);
        resolve(true);
      }, 300);
    });
    
    // Close on overlay click
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) {
        document.getElementById('deleteCancel').click();
      }
    });
    
    // Close on Escape key
    const handleEscape = (e) => {
      if (e.key === 'Escape') {
        document.getElementById('deleteCancel').click();
        document.removeEventListener('keydown', handleEscape);
      }
    };
    document.addEventListener('keydown', handleEscape);
  });
}

// Custom Narrin-styled notification system
function showNarrinNotification(type, title, message) {
  // Remove any existing notification
  const existingNotification = document.querySelector('.narrin-notification');
  if (existingNotification) {
    existingNotification.remove();
  }
  
  // Create notification element
  const notification = document.createElement('div');
  notification.className = 'narrin-notification';
  
  const icons = {
    success: '✅',
    error: '❌', 
    warning: '⚠️',
    info: 'ℹ️'
  };
  
  const colors = {
    success: { bg: 'linear-gradient(135deg, #10b981, #059669)', border: '#10b981' },
    error: { bg: 'linear-gradient(135deg, #ef4444, #dc2626)', border: '#ef4444' },
    warning: { bg: 'linear-gradient(135deg, #f59e0b, #d97706)', border: '#f59e0b' },
    info: { bg: 'var(--gradient-primary)', border: 'var(--color-teal)' }
  };
  
  notification.innerHTML = `
    <div class="narrin-notification-content">
      <div class="narrin-notification-icon">${icons[type]}</div>
      <div class="narrin-notification-text">
        <div class="narrin-notification-title">${title}</div>
        <div class="narrin-notification-message">${message}</div>
      </div>
      <button class="narrin-notification-close" onclick="this.parentElement.parentElement.remove()">✕</button>
    </div>
  `;
  
  // Add styles
  const style = document.createElement('style');
  style.textContent = `
    .narrin-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: ${colors[type].bg};
      color: white;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl);
      z-index: 999999999;
      animation: slideInRight 0.3s ease;
      max-width: 400px;
      min-width: 300px;
      border: 2px solid ${colors[type].border};
    }
    
    .narrin-notification-content {
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-md);
      padding: var(--spacing-lg);
    }
    
    .narrin-notification-icon {
      font-size: 24px;
      flex-shrink: 0;
      margin-top: 2px;
    }
    
    .narrin-notification-text {
      flex: 1;
      min-width: 0;
    }
    
    .narrin-notification-title {
      font-weight: 700;
      font-size: var(--font-size-base);
      margin-bottom: 4px;
      font-family: var(--font-secondary);
    }
    
    .narrin-notification-message {
      font-size: var(--font-size-sm);
      opacity: 0.95;
      line-height: 1.4;
    }
    
    .narrin-notification-close {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      padding: 4px;
      border-radius: 4px;
      transition: all 0.2s ease;
      opacity: 0.8;
      flex-shrink: 0;
    }
    
    .narrin-notification-close:hover {
      opacity: 1;
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }
    
    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @media (max-width: 768px) {
      .narrin-notification {
        top: auto;
        bottom: 20px;
        right: 20px;
        left: 20px;
        max-width: none;
      }
    }
  `;
  
  // Add styles if not already present
  if (!document.querySelector('#narrin-notification-styles')) {
    style.id = 'narrin-notification-styles';
    document.head.appendChild(style);
  }
  
  // Add to page
  document.body.appendChild(notification);
  
  // Auto remove after 5 seconds
  setTimeout(() => {
    if (notification.parentElement) {
      notification.remove();
    }
  }, 5000);
}

async function deleteCompanion(companionSlug, companionName, event) {
  event?.preventDefault();
  event?.stopPropagation();
  
  console.log('🗑️ Delete companion requested:', { companionSlug, companionName });
  
  // Check if this is a platform character (galina, blake, emerald, sol)
  const platformCharacters = ['galina', 'blake-devoted-boyfriend', 'emerald', 'sol'];
  const isPlatformCharacter = platformCharacters.includes(companionSlug);
  
  console.log('🔍 Character type check:', { companionSlug, isPlatformCharacter });
  
  // Show custom Narrin-styled confirmation dialog
  const confirmed = await showDeleteConfirmation(companionName, isPlatformCharacter);
  if (!confirmed) {
    console.log('❌ Delete cancelled by user');
    return;
  }
  
  try {
    if (isPlatformCharacter) {
      // Platform character - just hide locally
      console.log('🙈 Hiding platform character locally');
      
      const removedCompanions = JSON.parse(localStorage.getItem('removedCompanions') || '[]');
      console.log('🗂️ Before adding - removedCompanions:', removedCompanions);
      
      if (!removedCompanions.includes(companionSlug)) {
        removedCompanions.push(companionSlug);
        localStorage.setItem('removedCompanions', JSON.stringify(removedCompanions));
        console.log('✅ Platform character hidden. Updated removedCompanions:', removedCompanions);
        
        // Verify localStorage was saved correctly
        const verification = JSON.parse(localStorage.getItem('removedCompanions') || '[]');
        console.log('🔍 Verification - localStorage now contains:', verification);
      } else {
        console.log('ℹ️ Companion already in removedCompanions list');
      }
      
      showNarrinNotification('success', 'Companion Removed', 
        `${companionName} has been removed from your companions.`);
      
      // Immediately remove from DOM before reload
      const companionCard = document.querySelector(`[data-companion-slug="${companionSlug}"]`);
      if (companionCard) {
        companionCard.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        companionCard.style.opacity = '0';
        companionCard.style.transform = 'scale(0.9)';
        setTimeout(() => companionCard.remove(), 300);
      }
      
      // Check if we need to show empty state after removal
      setTimeout(() => {
        const remainingCards = document.querySelectorAll('.chat-card:not([style*="display: none"])');
        console.log('🔍 Remaining cards after deletion:', remainingCards.length);
        if (remainingCards.length === 0) {
          console.log('📭 No companions left - showing empty state');
          document.getElementById('emptyState').style.display = 'block';
          document.getElementById('chatsGrid').style.display = 'none';
        }
      }, 400);
      
    } else {
      // User-created character - hide locally first, then attempt deletion
      console.log('🗑️ Hiding user-created character locally...');
      
      // Always hide locally first for immediate UX
      let removedCompanions = JSON.parse(localStorage.getItem('removedCompanions') || '[]');
      if (!removedCompanions.includes(companionSlug)) {
        removedCompanions.push(companionSlug);
        localStorage.setItem('removedCompanions', JSON.stringify(removedCompanions));
        console.log('✅ User-created character added to removedCompanions:', removedCompanions);
      }
      
      // Remove from customizedCharacters 
      const customizedCharacters = JSON.parse(localStorage.getItem('customizedCharacters') || '{}');
      if (customizedCharacters[companionSlug]) {
        delete customizedCharacters[companionSlug];
        localStorage.setItem('customizedCharacters', JSON.stringify(customizedCharacters));
        console.log('🧹 Removed from localStorage customizedCharacters');
      }
      
      // Remove from DOM immediately
      const companionCard = document.querySelector(`[data-companion-slug="${companionSlug}"]`);
      if (companionCard) {
        companionCard.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        companionCard.style.opacity = '0';
        companionCard.style.transform = 'scale(0.9)';
        setTimeout(() => companionCard.remove(), 300);
      }
      
      showNarrinNotification('success', 'Companion Removed', 
        `${companionName} has been removed from your companions.`);
      
      // Attempt database deletion in background (best effort)
      console.log('🗑️ Attempting database deletion via Make.com...');
      
      const payload = {
        user_uid: localStorage.getItem('user_uid'),
        slug: companionSlug
      };
      
      console.log('📤 Sending payload to Netlify function:', payload);
      
      // Attempt database deletion in background (don't wait for success)
      try {
        const response = await fetch('/.netlify/functions/delete-companion', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        
        const responseText = await response.text();
        console.log('📥 Make.com deletion response:', responseText);
        
        if (response.ok) {
          const result = JSON.parse(responseText);
          console.log('✅ Database deletion result:', result);
        } else {
          console.warn('⚠️ Database deletion failed, but companion is hidden locally');
        }
      } catch (deleteError) {
        console.warn('⚠️ Database deletion error (companion still hidden locally):', deleteError);
      }
      
      // Check if we need to show empty state after removal
      setTimeout(() => {
        const remainingCards = document.querySelectorAll('.chat-card:not([style*="display: none"])');
        console.log('🔍 Remaining cards after deletion:', remainingCards.length);
        if (remainingCards.length === 0) {
          console.log('📭 No companions left - showing empty state');
          document.getElementById('emptyState').style.display = 'block';
          document.getElementById('chatsGrid').style.display = 'none';
        }
      }, 400);
    }
  } catch (error) {
    console.error('❌ Delete companion error:', error);
    showNarrinNotification('error', 'Delete Failed', 
      `Failed to delete ${companionName}. ${error.message}`);
  }
}

  </script>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-links">
        <a href="/" class="footer-link">Home</a>
        <span class="footer-separator">•</span>
        <a href="/news" class="footer-link">News & Insights</a>
        <span class="footer-separator">•</span>
        <a href="/chat-overview" class="footer-link">Chats</a>
        <span class="footer-separator">•</span>
        <a href="/create-character" class="footer-link">Create Companion</a>
        <span class="footer-separator">•</span>
        <a href="/contact" class="footer-link">Contact</a>
        <span class="footer-separator">•</span>
        <a href="/profile" class="footer-link">Profile</a>
        <span class="footer-separator">•</span>
        <a href="/privacy-policy" class="footer-link">Privacy Policy</a>
        <span class="footer-separator">•</span>
        <a href="/terms-and-conditions" class="footer-link">Terms and Conditions</a>
      </div>
      <p class="footer-copyright">© 2025 Narrin AI. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>